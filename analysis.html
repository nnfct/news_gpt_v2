<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç AI Îâ¥Ïä§ ÏÉÅÏÑ∏ Î∂ÑÏÑù</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #1C2039;
            min-height: 100vh;
            color: #343A40;
        }

        .header {
            text-align: center;
            padding: 40px 20px;
            color: white;
            background: linear-gradient(135deg, #1C2039 0%, #2C2C3A 100%);
            position: relative;
        }

        .back-btn {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-50%) scale(1.05);
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 300;
            margin-bottom: 10px;
            color: #00D9C0;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
            color: #E9ECEF;
            margin-bottom: 20px;
        }

        margin: 0;
        padding: 0;
        box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #1C2039;
            min-height: 100vh;
            color: #343A40;
        }

        .header {
            text-align: center;
            padding: 40px 20px;
            color: white;
            background: linear-gradient(135deg, #1C2039 0%, #2C2C3A 100%);
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 300;
            margin-bottom: 10px;
            color: #00D9C0;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
            color: #E9ECEF;
            margin-bottom: 20px;
        }

        .subscribe-btn {
            background: linear-gradient(135deg, #00D9C0, #00B8A9);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 217, 192, 0.3);
        }

        .subscribe-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 217, 192, 0.4);
        }

        .main-container {
            max-width: 1400px;
            /* 1200pxÏóêÏÑú 1400pxÎ°ú ÌôïÎåÄ */
            margin: 0 auto;
            padding: 0 20px;
        }

        .weekly-summary {
            background: white;
            border-radius: 16px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid #E9ECEF;
            min-height: 700px;
            /* 600pxÏóêÏÑú 700pxÎ°ú ÌôïÎåÄ */
        }

        .summary-container {
            display: flex;
            gap: 40px;
        }

        .summary-half {
            flex: 1;
            min-height: 620px;
            /* 520pxÏóêÏÑú 620pxÎ°ú ÌôïÎåÄ */
        }

        .summary-title {
            font-size: 1.5em;
            font-weight: 600;
            color: #343A40;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #E9ECEF;
        }

        .summary-title.domestic {
            color: #5A7DBC;
        }

        .summary-title.global {
            color: #d45252;
        }

        @media (max-width: 768px) {
            .summary-container {
                flex-direction: column;
                gap: 20px;
            }
        }

        .week-section {
            margin-bottom: 40px;
            padding: 20px;
            background: #FAFBFC;
            border-radius: 12px;
            border: 1px solid #F0F2F5;
        }

        .week-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .week-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #343A40;
        }

        .week-loading {
            font-size: 0.9em;
            color: #6C757D;
            font-style: italic;
        }

        .week-loading.hidden {
            display: none;
        }

        .industry-analysis {
            background: white;
            border-radius: 16px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid #E9ECEF;
            min-height: 600px;
        }

        .industry-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .industry-tab {
            background: #F0F2F5;
            color: #555555;
            border: 2px solid #E9ECEF;
            padding: 14px 22px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(240, 242, 245, 0.3);
        }

        .industry-tab.active {
            background: #5A7DBC;
            color: white;
            border-color: #5A7DBC;
            box-shadow: 0 4px 15px rgba(90, 125, 188, 0.3);
        }

        .industry-tab:hover:not(.active) {
            background: #F5F7FA;
            border-color: #5A7DBC;
            transform: translateY(-1px);
        }

        .section-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #343A40;
            margin-bottom: 20px;
            border-bottom: 3px solid #00D9C0;
            padding-bottom: 10px;
            display: inline-block;
        }

        .keywords-container {
            display: flex;
            gap: 8px;
            /* 10pxÏóêÏÑú 8pxÎ°ú Ï§ÑÏó¨ÏÑú Top 5Í∞Ä ÌïúÏ§ÑÏóê Îçî Ïûò Îì§Ïñ¥Í∞ÄÎèÑÎ°ù */
            flex-wrap: wrap;
            min-height: 150px;
            /* 120pxÏóêÏÑú 150pxÎ°ú ÌôïÎåÄÌïòÏó¨ Top 5 ÌÇ§ÏõåÎìú ÏàòÏö© */
            align-content: flex-start;
            justify-content: flex-start;
            width: 100%;
            /* Ï†ÑÏ≤¥ ÎÑàÎπÑ ÏÇ¨Ïö© */
        }

        .keyword-tag {
            background: #F0F2F5;
            color: #555555;
            padding: 8px 14px;
            /* 10px 16pxÏóêÏÑú 8px 14pxÎ°ú Ï§ÑÏó¨ÏÑú Top 5Í∞Ä ÌïúÏ§ÑÏóê Îçî Ïûò Îì§Ïñ¥Í∞ÄÎèÑÎ°ù */
            border-radius: 25px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(240, 242, 245, 0.4);
            position: relative;
            border: 1px solid #E9ECEF;
            font-size: 0.85em;
            /* 0.9emÏóêÏÑú 0.85emÎ°ú Îçî Ï§ÑÏó¨ÏÑú Í≥µÍ∞Ñ Ìö®Ïú®ÏÑ± */
            white-space: nowrap;
            /* ÌÇ§ÏõåÎìúÍ∞Ä Ï§ÑÎ∞îÍøà ÎêòÏßÄ ÏïäÎèÑÎ°ù */
            flex-shrink: 0;
            /* ÌÅ¨Í∏∞ Ï∂ïÏÜå Î∞©ÏßÄ */
        }

        .keyword-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(90, 125, 188, 0.5);
            background: #5A7DBC;
            color: #FFFFFF;
        }

        .keyword-tag.selected {
            background: #5A7DBC;
            color: #FFFFFF;
            box-shadow: 0 4px 15px rgba(90, 125, 188, 0.4);
        }

        .analysis-content {
            background: white;
            padding: 25px;
            border-radius: 12px;
            min-height: 200px;
            line-height: 1.6;
            color: #343A40;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .analysis-section {
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #5A7DBC;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .counter-analysis-section {
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #DC3545;
            background: #FFF5F5;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .analysis-title {
            font-weight: 600;
            color: #343A40;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .counter-title {
            font-weight: 600;
            color: #DC3545;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .loading {
            text-align: center;
            color: #6C757D;
            font-style: italic;
        }

        /* ÌÇ§ÏõåÎìú Í¥ÄÎ†® Í∏∞ÏÇ¨ Î™®Îã¨ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(28, 32, 57, 0.8);
            z-index: 1000;
        }

        .modal-content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #F5F7FA;
            border-radius: 16px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            z-index: 1001;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #E9ECEF;
            padding-bottom: 15px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #6C757D;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #5A7DBC;
        }

        .articles-grid {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }

        .article-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #5A7DBC;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .article-card:hover {
            background: #F5F7FA;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(90, 125, 188, 0.2);
        }

        .article-card[style*="cursor: pointer"]:hover {
            border-left-color: #00D9C0;
            background: #F0FDFC;
            box-shadow: 0 4px 12px rgba(0, 217, 192, 0.3);
        }

        .article-card[style*="cursor: pointer"]:hover::after {
            content: "üîó";
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 16px;
            color: #00D9C0;
        }

        /* URLÏù¥ ÏóÜÎäî Í∏∞ÏÇ¨ Ïπ¥Îìú Ïä§ÌÉÄÏùº */
        .article-card.no-url {
            border-left-color: #dc3545;
            opacity: 0.8;
        }

        .article-card.no-url:hover {
            border-left-color: #dc3545;
            background: #fff5f5;
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.2);
            transform: none;
        }

        .article-card.no-url:hover::after {
            content: "üö´";
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 16px;
            color: #dc3545;
        }

        .article-date {
            font-size: 12px;
            color: #6C757D;
            margin-bottom: 5px;
        }

        .article-title {
            font-weight: 600;
            color: #343A40;
            margin-bottom: 8px;
        }

        .article-summary {
            color: #6C757D;
            line-height: 1.5;
        }

        .chatbot-section {
            background: #F5F7FA;
            border-radius: 16px;
            padding: 40px;
            margin-top: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid #E9ECEF;
            min-height: 600px;
        }

        .chat-suggestions {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .suggestion-title {
            font-weight: 600;
            color: #343A40;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .suggestions-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .suggestion-item {
            background: #F0F2F5;
            color: #555555;
            padding: 10px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 13px;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(240, 242, 245, 0.3);
            border: 1px solid #E9ECEF;
        }

        .suggestion-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(90, 125, 188, 0.4);
            background: #5A7DBC;
            color: #FFFFFF;
        }

        .chat-history {
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #E9ECEF;
            border-radius: 12px;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .chat-message {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        .chat-user {
            align-self: flex-end;
            background: #5A7DBC;
            color: white;
            padding: 10px 16px;
            border-radius: 18px 18px 4px 18px;
            max-width: 70%;
            word-wrap: break-word;
            box-shadow: 0 2px 8px rgba(90, 125, 188, 0.3);
        }

        .chat-bot {
            align-self: flex-start;
            background: #E9ECEF;
            color: #343A40;
            padding: 10px 16px;
            border-radius: 18px 18px 18px 4px;
            max-width: 70%;
            word-wrap: break-word;
            line-height: 1.5;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #E9ECEF;
            border-radius: 25px;
            outline: none;
            font-size: 14px;
            transition: border-color 0.3s ease;
            background: white;
            color: #343A40;
        }

        .chat-input:focus {
            border-color: #5A7DBC;
            box-shadow: 0 0 0 3px rgba(90, 125, 188, 0.1);
        }

        .chat-send {
            background: #5A7DBC;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(90, 125, 188, 0.3);
        }

        .chat-send:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(90, 125, 188, 0.4);
            background: #4A6DA7;
        }

        .chat-send:disabled {
            background: #6C757D;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .typing-dots {
            animation: typing 1.5s infinite;
        }

        @keyframes typing {

            0%,
            20% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(0, 123, 255, 0.7);
            }

            50% {
                transform: scale(1.02);
                box-shadow: 0 0 0 8px rgba(0, 217, 192, 0.3);
            }

            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(0, 123, 255, 0);
            }
        }

        /* üöÄ Í≥†ÏÑ±Îä• Ïä§ÏºàÎ†àÌÜ§ UI (Ï¶âÏãú Î°úÎî© Ìö®Í≥º) */
        .skeleton {
            background: linear-gradient(90deg, #f0f2f5 25%, #e9ecef 50%, #f0f2f5 75%);
            background-size: 200% 100%;
            animation: loading-skeleton 1.2s ease-in-out infinite;
            border-radius: 8px;
            transform: translateZ(0);
            /* GPU Í∞ÄÏÜç */
        }

        .skeleton-keyword {
            height: 35px;
            /* 40pxÏóêÏÑú 35pxÎ°ú Ï§ÑÏó¨ÏÑú Top 5Í∞Ä ÌïúÏ§ÑÏóê Îì§Ïñ¥Í∞ÄÎèÑÎ°ù */
            width: 100px;
            /* 120pxÏóêÏÑú 100pxÎ°ú Ï§ÑÏó¨ÏÑú Í≥µÍ∞Ñ Ìö®Ïú®ÏÑ± */
            margin: 6px;
            /* 8pxÏóêÏÑú 6pxÎ°ú Ï§ÑÏó¨ÏÑú Îçî Ï¥òÏ¥òÌïòÍ≤å */
            border-radius: 20px;
            display: inline-block;
            position: relative;
        }

        .skeleton-keyword::after {
            content: "‚ö°";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #5A7DBC;
            font-size: 16px;
            animation: pulse-icon 1s ease-in-out infinite;
        }

        @keyframes pulse-icon {

            0%,
            100% {
                opacity: 0.3;
                transform: translate(-50%, -50%) scale(1);
            }

            50% {
                opacity: 0.8;
                transform: translate(-50%, -50%) scale(1.1);
            }
        }

        @keyframes loading-skeleton {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }

        /* üî• Ï¶âÏãú Î∞òÏùë Ìö®Í≥º ÏãúÏä§ÌÖú */
        .instant-feedback {
            transform: scale(1);
            transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .instant-feedback::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.5s ease;
        }

        .instant-feedback:hover::before {
            left: 100%;
        }

        .instant-feedback:active {
            transform: scale(0.98);
        }

        .quick-hover {
            transition: all 0.15s ease !important;
        }

        .quick-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(90, 125, 188, 0.3);
        }

        /* ‚ö° ÌîÑÎ¶¨Î°úÎî© Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ */
        .preload-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            z-index: 9999;
            display: none;
            border: 2px solid #5A7DBC;
        }

        .preload-indicator.show {
            display: block;
            animation: fadeInFast 0.2s ease;
        }

        @keyframes fadeInFast {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: scale(1);
            }

            to {
                opacity: 0;
                transform: scale(0.95);
            }
        }

        /* üèÉ‚Äç‚ôÇÔ∏è ÏÑ±Îä• ÏÉÅÌÉú Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ */
        .performance-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(16, 185, 129, 0.9);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* üí® Îπ†Î•∏ Î°úÎî© ÏÉÅÌÉú */
        .fast-loading {
            position: relative;
            overflow: hidden;
        }

        .fast-loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 217, 192, 0.3), transparent);
            animation: fastSweep 1s ease-in-out infinite;
        }

        @keyframes fastSweep {
            0% {
                left: -100%;
            }

            100% {
                left: 100%;
            }
        }

        /* üöÄ ÏùºÎ∞ò ÏÑ±Îä• Î™®Îìú (GPU Í∞ÄÏÜç Ï†úÍ±∞) */
        .high-performance-mode .keyword-tag:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 6px 20px rgba(90, 125, 188, 0.3);
        }

        .high-performance-mode .article-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }

        /* Ïà®ÍπÄ ÌÅ¥ÎûòÏä§ */
        .hidden {
            opacity: 0 !important;
            visibility: hidden !important;
            transition: all 0.3s ease !important;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .main-container {
                max-width: 100%;
                padding: 0 15px;
            }

            .weekly-summary {
                padding: 30px 20px;
                margin: 20px 0;
            }

            .summary-container {
                flex-direction: column;
                gap: 30px;
            }

            .keywords-container {
                gap: 6px;
                /* 8pxÏóêÏÑú 6pxÎ°ú Ï§ÑÏó¨ÏÑú Top 5Í∞Ä Î™®Î∞îÏùºÏóêÏÑúÎèÑ ÌïúÏ§ÑÏóê */
                min-height: 140px;
                /* 120pxÏóêÏÑú 140pxÎ°ú ÌôïÎåÄÌïòÏó¨ Top 5 ÏàòÏö© */
            }

            .keyword-tag {
                padding: 8px 12px;
                /* 10px 16pxÏóêÏÑú 8px 12pxÎ°ú Ï§ÑÏó¨ÏÑú Top 5 ÏàòÏö© */
                font-size: 0.85em;
                /* 0.9emÏóêÏÑú 0.85emÎ°ú Ï§ÑÏó¨ÏÑú Í≥µÍ∞Ñ ÌôïÎ≥¥ */
                text-align: center;
            }

            .industry-tabs {
                flex-direction: column;
            }

            .industry-tab {
                text-align: center;
            }

            .suggestions-container {
                grid-template-columns: 1fr;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>üîç AI Îâ¥Ïä§ ÌÇ§ÏõåÎìú Î∂ÑÏÑù</h1>
        <p class="subtitle">Ï£ºÍ∞Ñ Ìä∏Î†åÎìúÏôÄ ÏÇ∞ÏóÖÎ≥Ñ Î∂ÑÏÑùÏùÑ ÌïúÎààÏóê</p>
        <button class="subscribe-btn" onclick="openSubscribeModal()">
            üìß Ï£ºÍ∞Ñ Ïù∏ÏÇ¨Ïù¥Ìä∏ Íµ¨ÎèÖÌïòÍ∏∞
        </button>
    </div>

    <div class="main-container">
        <!-- Ï£ºÍ∞Ñ ÏöîÏïΩ ÏÑπÏÖò -->
        <div class="weekly-summary">
            <div class="summary-container">
                <!-- Íµ≠ÎÇ¥ Ï£ºÍ∞Ñ ÏöîÏïΩ -->
                <div class="summary-half">
                    <h2 class="summary-title domestic">üá∞üá∑ Íµ≠ÎÇ¥ Ï£ºÍ∞Ñ ÌÇ§ÏõåÎìú Top5</h2>

                    <!-- 7Ïõî 1Ï£ºÏ∞® (7/1~7/5) -->
                    <div class="week-section">
                        <div class="week-header">
                            <h3 class="week-title">7Ïõî 1Ï£ºÏ∞® (2025.07.01 ~ 2025.07.05)</h3>
                            <div class="week-loading" id="week1-loading">Top5 ÌÇ§ÏõåÎìú Î∂ÑÏÑù Ï§ë...</div>
                        </div>
                        <div class="keywords-container" id="week1-keywords">
                            <!-- 1Ï£ºÏ∞® ÌÇ§ÏõåÎìúÎì§ -->
                        </div>
                    </div>

                    <!-- 7Ïõî 2Ï£ºÏ∞® (7/6~7/13) -->
                    <div class="week-section">
                        <div class="week-header">
                            <h3 class="week-title">7Ïõî 2Ï£ºÏ∞® (2025.07.06 ~ 2025.07.13)</h3>
                            <div class="week-loading" id="week2-loading">Top5 ÌÇ§ÏõåÎìú Î∂ÑÏÑù Ï§ë...</div>
                        </div>
                        <div class="keywords-container" id="week2-keywords">
                            <!-- 2Ï£ºÏ∞® ÌÇ§ÏõåÎìúÎì§ -->
                        </div>
                    </div>

                    <!-- 7Ïõî 3Ï£ºÏ∞® (7/14~7/18) -->
                    <div class="week-section">
                        <div class="week-header">
                            <h3 class="week-title">7Ïõî 3Ï£ºÏ∞® (2025.07.14 ~ 2025.07.18) - ÌòÑÏû¨</h3>
                            <div class="week-loading" id="week3-loading">Top5 ÌÇ§ÏõåÎìú Î∂ÑÏÑù Ï§ë...</div>
                        </div>
                        <div class="keywords-container" id="week3-keywords">
                            <!-- 3Ï£ºÏ∞® ÌÇ§ÏõåÎìúÎì§ -->
                        </div>
                    </div>
                </div>

                <!-- Ìï¥Ïô∏ Ï£ºÍ∞Ñ ÏöîÏïΩ -->
                <div class="summary-half">
                    <h2 class="summary-title global">üåç Ìï¥Ïô∏ Ï£ºÍ∞Ñ ÌÇ§ÏõåÎìú Top5</h2>

                    <!-- 7Ïõî 1Ï£ºÏ∞® (7/1~7/5) -->
                    <div class="week-section">
                        <div class="week-header">
                            <h3 class="week-title">7Ïõî 1Ï£ºÏ∞® (2025.07.01 ~ 2025.07.05)</h3>
                            <div class="week-loading" id="global-week1-loading">Top5 ÌÇ§ÏõåÎìú Î∂ÑÏÑù Ï§ë...</div>
                        </div>
                        <div class="keywords-container" id="global-week1-keywords">
                            <!-- Ìï¥Ïô∏ 1Ï£ºÏ∞® ÌÇ§ÏõåÎìúÎì§ -->
                        </div>
                    </div>

                    <!-- 7Ïõî 2Ï£ºÏ∞® (7/6~7/13) -->
                    <div class="week-section">
                        <div class="week-header">
                            <h3 class="week-title">7Ïõî 2Ï£ºÏ∞® (2025.07.06 ~ 2025.07.13)</h3>
                            <div class="week-loading" id="global-week2-loading">Top5 ÌÇ§ÏõåÎìú Î∂ÑÏÑù Ï§ë...</div>
                        </div>
                        <div class="keywords-container" id="global-week2-keywords">
                            <!-- Ìï¥Ïô∏ 2Ï£ºÏ∞® ÌÇ§ÏõåÎìúÎì§ -->
                        </div>
                    </div>

                    <!-- 7Ïõî 3Ï£ºÏ∞® (7/14~7/18) -->
                    <div class="week-section">
                        <div class="week-header">
                            <h3 class="week-title">7Ïõî 3Ï£ºÏ∞® (2025.07.14 ~ 2025.07.18) - ÌòÑÏû¨</h3>
                            <div class="week-loading" id="global-week3-loading">Top5 ÌÇ§ÏõåÎìú Î∂ÑÏÑù Ï§ë...</div>
                        </div>
                        <div class="keywords-container" id="global-week3-keywords">
                            <!-- Ìï¥Ïô∏ 3Ï£ºÏ∞® ÌÇ§ÏõåÎìúÎì§ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÏÇ∞ÏóÖÎ≥Ñ Î∂ÑÏÑù ÏÑπÏÖò -->
        <div class="industry-analysis">
            <h2 class="section-title">Ïù¥Îü∞ ÏãúÍ∞ÅÏùÄ Ïñ¥ÎïåÏöî?</h2>
            <div class="industry-tabs">
                <div class="industry-tab active" data-industry="ÏÇ¨Ìöå">ÏÇ¨Ìöå</div>
                <div class="industry-tab" data-industry="Í≤ΩÏ†ú">Í≤ΩÏ†ú</div>
                <div class="industry-tab" data-industry="IT/Í≥ºÌïô">IT/Í≥ºÌïô</div>
                <div class="industry-tab" data-industry="ÏÉùÌôú/Î¨∏Ìôî">ÏÉùÌôú/Î¨∏Ìôî</div>
                <div class="industry-tab" data-industry="ÏÑ∏Í≥Ñ">ÏÑ∏Í≥Ñ</div>
            </div>
            <div class="analysis-content" id="analysis-content">
                <div class="loading">Î∂ÑÏÑùÌï† ÌÇ§ÏõåÎìúÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</div>
            </div>
        </div>

        <!-- Ï±óÎ¥á ÏÑπÏÖò -->
        <div class="chatbot-section">
            <h2 class="section-title">üí¨ AI Îâ¥Ïä§ Î∂ÑÏÑù Ï±óÎ¥á</h2>
            <div class="chat-suggestions">
                <div class="suggestion-title">üí° Ïù¥Îü∞ ÏßàÎ¨∏ÏùÑ Ìï¥Î≥¥ÏÑ∏Ïöî:</div>
                <div class="suggestions-container">
                    <!-- Ï†úÏïà ÏßàÎ¨∏Îì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                </div>
            </div>
            <div class="chat-history" id="chat-history">
                <div class="chat-message">
                    <div class="chat-bot">
                        ÏïàÎÖïÌïòÏÑ∏Ïöî! Ï†ÄÎäî Ï£ºÍ∞Ñ ÌÇ§ÏõåÎìú Î∂ÑÏÑù Í∏∞Î∞ò AI Ï±óÎ¥áÏûÖÎãàÎã§. ü§ñ<br>
                        <strong>ÌòÑÏû¨ Ï£ºÍ∞Ñ ÌïµÏã¨ ÌÇ§ÏõåÎìúÎ•º Í∏∞Î∞òÏúºÎ°ú</strong> Îã§ÏñëÌïú Í¥ÄÏ†êÏóêÏÑú ÎãµÎ≥ÄÌï¥ÎìúÎ¶ΩÎãàÎã§.<br><br>
                        üìå <strong>ÏßàÎ¨∏ Ïú†Ìòï:</strong><br>
                        ‚Ä¢ ÏÇ∞ÏóÖÎ≥Ñ Î∂ÑÏÑù: "Ïù∏Í≥µÏßÄÎä•Ïùò Í≤ΩÏ†úÏ†Å ÏòÅÌñ•ÏùÄ?"<br>
                        ‚Ä¢ ÌÇ§ÏõåÎìú Ìä∏Î†åÎìú: "Î∞òÎèÑÏ≤¥ ÏµúÍ∑º ÎèôÌñ•ÏùÄ?"<br>
                        ‚Ä¢ ÎπÑÍµê Î∂ÑÏÑù: "AI vs Î∞òÎèÑÏ≤¥ ÎπÑÍµê"<br>
                        ‚Ä¢ ÏùºÎ∞ò ÏßàÎ¨∏: "ÌòÑÏû¨ Ï£ºÏöî Îâ¥Ïä§Îäî?"
                    </div>
                </div>
            </div>
            <div class="chat-input-container">
                <input type="text" id="chat-input" class="chat-input" placeholder="Ï£ºÍ∞Ñ ÌÇ§ÏõåÎìú Í∏∞Î∞òÏúºÎ°ú Îâ¥Ïä§Î•º Î∂ÑÏÑùÌï¥ÎìúÎ¶ΩÎãàÎã§..." />
                <button id="chat-send" class="chat-send">Ï†ÑÏÜ°</button>
            </div>
        </div>
    </div>

    <!-- ÌÇ§ÏõåÎìú Í¥ÄÎ†® Í∏∞ÏÇ¨ Î™®Îã¨ -->
    <div class="modal" id="article-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Í¥ÄÎ†® Í∏∞ÏÇ¨</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div id="modal-articles">
                <!-- Í¥ÄÎ†® Í∏∞ÏÇ¨Îì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
            </div>
        </div>
    </div>

    <!-- ÌîÑÎ¶¨Î°úÎìú Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ -->
    <div id="preload-indicator" class="preload-indicator">
        <div style="text-align: center;">
            <div class="typing-dots">‚ö° Î°úÎî© Ï§ë...</div>
        </div>
    </div>

    <script>
        // üöÄ Í≥†ÏÑ±Îä• ÏµúÏ†ÅÌôîÎêú Ï†ÑÏó≠ Î≥ÄÏàò
        let currentKeywords = [];
        let selectedKeyword = null;
        let dataCache = {}; // ÏùºÎ∞ò Í∞ùÏ≤¥Î°ú Î≥ÄÍ≤Ω (Map ÎåÄÏã†)
        let performanceMetrics = {
            startTime: Date.now(),
            cacheHits: 0,
            totalRequests: 0,
            avgResponseTime: 0
        };

        // ‚ö° Ï¶âÏãú ÏÑ±Îä• Î∞∞ÏßÄ ÌëúÏãú
        function showPerformanceBadge(text = '‚ö° Í≥†ÏÜç Î∂ÑÏÑù Î™®Îìú') {
            const badge = document.createElement('div');
            badge.className = 'performance-badge';
            badge.innerHTML = text;
            document.body.appendChild(badge);

            // 3Ï¥à ÌõÑ ÏûêÎèô Ïà®ÍπÄ
            setTimeout(() => {
                if (badge && badge.parentNode) {
                    badge.style.opacity = '0';
                    badge.style.transform = 'translateX(100%)';
                    setTimeout(() => badge.remove(), 300);
                }
            }, 3000);
        }

        // üî• Ï¥àÍ≥†ÏÜç Ïä§ÏºàÎ†àÌÜ§ UI (Ï¶âÏãú Î°úÎî© Ìö®Í≥º)
        function showSkeletonUI() {
            console.log('üöÄ Ïä§ÏºàÎ†àÌÜ§ UI Ï¶âÏãú ÌëúÏãú');
            for (let week = 1; week <= 3; week++) {
                showSkeletonForWeek(week, 'domestic');
                showSkeletonForWeek(week, 'global');
            }

            // Ïä§ÏºàÎ†àÌÜ§ ÌëúÏãú ÌõÑ Ï¶âÏãú Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º Ï†ÅÏö©
            setTimeout(() => {
                document.querySelectorAll('.skeleton').forEach((el, index) => {
                    el.style.animationDelay = `${index * 0.1}s`;
                    el.classList.add('fast-loading');
                });
            }, 100);
        }

        function showSkeletonForWeek(weekNumber, region) {
            const elementPrefix = region === 'global' ? 'global-' : '';
            const container = document.getElementById(`${elementPrefix}week${weekNumber}-keywords`);
            if (container) {
                container.innerHTML = `
                    <div class="skeleton skeleton-keyword"></div>
                    <div class="skeleton skeleton-keyword"></div>
                    <div class="skeleton skeleton-keyword"></div>
                    <div class="skeleton skeleton-keyword"></div>
                    <div class="skeleton skeleton-keyword"></div>
                `;
            }
        }

        // Ïä§ÏºàÎ†àÌÜ§ UI Ïà®Í∏∞Í∏∞
        function hideSkeletonUI() {
            document.querySelectorAll('.skeleton').forEach(el => {
                el.style.opacity = '0';
                setTimeout(() => el.remove(), 300);
            });
        }

        // ‚ö° ÌîÑÎ¶¨Î°úÎî© Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ (Í≥†ÏÑ±Îä•)
        function showPreloadIndicator(message = 'üî• Ï¥àÍ≥†ÏÜç Î∂ÑÏÑù Ï§ë...') {
            let indicator = document.getElementById('preload-indicator');
            if (!indicator) {
                indicator = document.createElement('div');
                indicator.id = 'preload-indicator';
                indicator.className = 'preload-indicator';
                document.body.appendChild(indicator);
            }
            indicator.innerHTML = `
                <div style="text-align: center;">
                    <div class="typing-dots">${message}</div>
                    <div style="font-size: 12px; margin-top: 10px; color: #666;">
                        Ï∫êÏãú Ï†ÅÏ§ë: ${performanceMetrics.cacheHits}/${performanceMetrics.totalRequests}
                    </div>
                </div>
            `;
            indicator.classList.add('show');
        }

        function hidePreloadIndicator() {
            const indicator = document.getElementById('preload-indicator');
            if (indicator) {
                indicator.classList.remove('show');
                // ÏÑ±Îä• Î©îÌä∏Î¶≠ ÏóÖÎç∞Ïù¥Ìä∏
                const elapsed = Date.now() - performanceMetrics.startTime;
                showPerformanceBadge(`‚úÖ ÏôÑÎ£å (${(elapsed / 1000).toFixed(1)}Ï¥à)`);
            }
        }

        // Ï¶âÏãú ÌîºÎìúÎ∞± Ìö®Í≥º Ï†ÅÏö© (Í∞ÑÏÜåÌôî)
        function applyInstantFeedback(element) {
            element.addEventListener('mouseenter', function () {
                this.style.transform = 'translateY(-2px) scale(1.02)';
                this.style.transition = 'all 0.2s ease';
            });

            element.addEventListener('mouseleave', function () {
                this.style.transform = 'translateY(0) scale(1)';
                this.style.transition = 'all 0.2s ease';
            });
        }

        // üöÄ ÌéòÏù¥ÏßÄ Î°úÎìúÏãú Ï¶âÏãú ÏµúÏ†ÅÌôîÎêú Î°úÎî©
        document.addEventListener('DOMContentLoaded', function () {
            console.log('üöÄ Í≥†ÏÑ±Îä• Î™®Îìú ÏãúÏûë');
            performanceMetrics.startTime = Date.now();

            // Ï¶âÏãú ÏÑ±Îä• Î∞∞ÏßÄ ÌëúÏãú
            showPerformanceBadge('‚ö° Ï¥àÍ≥†ÏÜç Î°úÎî© ÏãúÏûë');

            // 0ms ÎîúÎ†àÏù¥Î°ú Ï¶âÏãú Ïä§ÏºàÎ†àÌÜ§ UI ÌëúÏãú
            showSkeletonUI();

            // Ï¶âÏãú ÌîºÎìúÎ∞± ÏãúÏä§ÌÖú ÌôúÏÑ±Ìôî
            document.body.classList.add('high-performance-mode');

            // 100ms ÌõÑ Ïã§Ï†ú Î°úÎî© ÏãúÏûë (Ï¶âÏãú ÏãúÏûë)
            setTimeout(() => {
                console.log('üî• Î°úÎî© Ìï®ÏàòÎì§ Ìò∏Ï∂ú ÏãúÏûë');
                try {
                    setupIndustryTabs();
                    console.log('‚úÖ setupIndustryTabs ÏôÑÎ£å');
                } catch (error) {
                    console.error('‚ùå setupIndustryTabs Ïò§Î•ò:', error);
                }

                try {
                    initializeChatSuggestions();
                    console.log('‚úÖ initializeChatSuggestions ÏôÑÎ£å');
                } catch (error) {
                    console.error('‚ùå initializeChatSuggestions Ïò§Î•ò:', error);
                }

                try {
                    loadAllWeeklyKeywordsOptimized();
                    console.log('‚úÖ loadAllWeeklyKeywordsOptimized Ìò∏Ï∂ú ÏôÑÎ£å');
                } catch (error) {
                    console.error('‚ùå loadAllWeeklyKeywordsOptimized Ïò§Î•ò:', error);
                }
            }, 100); // 500ms ‚Üí 100msÎ°ú Îã®Ï∂ï

            // 1Ï¥à ÌõÑ ÏµúÏ¢Ö ÏôÑÎ£å
            setTimeout(() => {
                hidePreloadIndicator();
                console.log('üéâ Í≥†ÏÑ±Îä• Î°úÎî© ÏôÑÎ£å');
            }, 1000);

            // Ï±óÎ¥á Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
            const chatSendBtn = document.getElementById('chat-send');
            const chatInput = document.getElementById('chat-input');

            if (chatSendBtn) {
                chatSendBtn.addEventListener('click', sendChat);
            }

            if (chatInput) {
                chatInput.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        sendChat();
                    }
                });
            }
        });

        // üî• ÏµúÏ†ÅÌôîÎêú ÌÇ§ÏõåÎìú Î°úÎî© (Ï∫êÏã± + Î≥ëÎ†¨ Ï≤òÎ¶¨)
        async function loadAllWeeklyKeywordsOptimized() {
            showPerformanceBadge('üî• Ï†ÑÏ≤¥ ÌÇ§ÏõåÎìú Î°úÎî© ÏãúÏûë');

            const weeks = [1, 2, 3];
            const promises = [];

            for (const week of weeks) {
                // Íµ≠ÎÇ¥ Î∞è Ìï¥Ïô∏ ÌÇ§ÏõåÎìú Î≥ëÎ†¨ Î°úÎî©
                promises.push(loadWeekKeywordsOptimized(week, 'domestic'));
                promises.push(loadWeekKeywordsOptimized(week, 'global'));
            }

            try {
                await Promise.all(promises);
                showPerformanceBadge('‚úÖ Î™®Îì† ÌÇ§ÏõåÎìú Î°úÎî© ÏôÑÎ£å!');
            } catch (error) {
                console.error('ÌÇ§ÏõåÎìú Î°úÎî© Ïò§Î•ò:', error);
                showPerformanceBadge('‚ö†Ô∏è ÏùºÎ∂Ä ÌÇ§ÏõåÎìú Î°úÎî© Ïã§Ìå®');
            }
        }

        // üöÄ ÏµúÏ†ÅÌôîÎêú ÌÇ§ÏõåÎìú ÌëúÏãú (Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º)
        function displayWeekKeywordsOptimized(container, keywords, weekNumber, region = 'domestic') {
            if (!container) return;

            container.innerHTML = '';
            const weekDateRanges = {
                1: { start: '2025-07-01', end: '2025-07-05' },
                2: { start: '2025-07-06', end: '2025-07-13' },
                3: { start: '2025-07-14', end: '2025-07-18' }
            };

            keywords.forEach((keyword, index) => {
                setTimeout(() => {
                    const keywordElement = document.createElement('div');
                    keywordElement.className = 'keyword-tag instant-feedback quick-hover';
                    keywordElement.textContent = keyword;
                    keywordElement.setAttribute('data-region', region);

                    // Ï∫êÏãúÎêú Ìï≠Î™© ÌëúÏãú
                    if (dataCache.has(`${region}-${weekNumber}-${weekDateRanges[weekNumber].start}-${weekDateRanges[weekNumber].end}`)) {
                        keywordElement.style.borderLeft = '3px solid #10b981';
                        keywordElement.title = 'Ï∫êÏãúÎêú Îç∞Ïù¥ÌÑ∞ (Îπ†Î•∏ Î°úÎî©)';
                    }

                    // ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
                    keywordElement.addEventListener('click', function () {
                        // Ï¶âÏãú ÌîºÎìúÎ∞±
                        this.style.transform = 'scale(0.95)';
                        setTimeout(() => this.style.transform = '', 100);

                        selectedKeyword = keyword;
                        currentKeywords = [keyword];
                        const dateRange = weekDateRanges[weekNumber];

                        performKeywordAnalysis(keyword);
                        openArticleModalOptimized(keyword, dateRange, region);
                    });

                    // Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥ºÎ°ú Îì±Ïû•
                    keywordElement.style.opacity = '0';
                    keywordElement.style.transform = 'translateY(20px)';
                    container.appendChild(keywordElement);

                    // Î∂ÄÎìúÎü¨Ïö¥ Îì±Ïû• Ïï†ÎãàÎ©îÏù¥ÏÖò
                    requestAnimationFrame(() => {
                        keywordElement.style.transition = 'all 0.3s ease';
                        keywordElement.style.opacity = '1';
                        keywordElement.style.transform = 'translateY(0)';
                    });

                }, index * 100); // ÏàúÏ∞®Ï†Å Îì±Ïû• (100ms Í∞ÑÍ≤©)
            });
        }

        // üöÄ ÏµúÏ†ÅÌôîÎêú Ï£ºÏ∞®Î≥Ñ ÌÇ§ÏõåÎìú Î°úÎî© (Îπ†Î•∏ Î≤ÑÏ†Ñ)
        async function loadWeekKeywordsOptimized(weekNumber, region = 'domestic') {
            console.log(`üîÑ ${weekNumber}Ï£ºÏ∞® ${region} ÌÇ§ÏõåÎìú Î°úÎî© ÏãúÏûë`);

            try {
                // ÎÇ†Ïßú Î≤îÏúÑ Í≥ÑÏÇ∞
                const weekDateRanges = {
                    1: { start: '2025-07-01', end: '2025-07-05' },
                    2: { start: '2025-07-06', end: '2025-07-13' },
                    3: { start: '2025-07-14', end: '2025-07-18' }
                };

                const { start: startDate, end: endDate } = weekDateRanges[weekNumber];
                const cacheKey = `${region}-${weekNumber}-${startDate}-${endDate}`;
                const keywordsContainer = document.getElementById(`${region === 'global' ? 'global-' : ''}week${weekNumber}-keywords`);
                const loadingElement = document.getElementById(`${region === 'global' ? 'global-' : ''}week${weekNumber}-loading`);

                console.log(`üì¶ Ïª®ÌÖåÏù¥ÎÑà ÌôïÏù∏: ${keywordsContainer ? '‚úÖ' : '‚ùå'}, Î°úÎî© ÏöîÏÜå: ${loadingElement ? '‚úÖ' : '‚ùå'}`);

                // Ï∫êÏãú ÌôïÏù∏
                if (dataCache[cacheKey]) {
                    console.log(`üí® Ï∫êÏãúÏóêÏÑú Î°úÎî©: ${cacheKey}`);
                    displayWeekKeywords(keywordsContainer, dataCache[cacheKey], weekNumber, region);
                    if (loadingElement) {
                        loadingElement.classList.add('hidden');
                    }
                    return;
                }

                // Ï¶âÏãú "Î∂ÑÏÑù Ï§ë..." ÌëúÏãú
                if (loadingElement) {
                    loadingElement.textContent = '‚ö° Îπ†Î•∏ Î∂ÑÏÑù Ï§ë...';
                    loadingElement.style.color = '#00D9C0';
                }

                // Ìï¥Ïô∏Îäî global-weekly-keywords-by-date, Íµ≠ÎÇ¥Îäî weekly-keywords-by-date ÏÇ¨Ïö©
                const apiEndpoint = region === 'global'
                    ? `http://127.0.0.1:8000/global-weekly-keywords-by-date?start_date=${startDate}&end_date=${endDate}`
                    : `http://127.0.0.1:8000/weekly-keywords-by-date?start_date=${startDate}&end_date=${endDate}`;

                console.log(`üåê API Ìò∏Ï∂ú: ${apiEndpoint}`);

                // ÌÉÄÏûÑÏïÑÏõÉÏùÑ 5Ï¥àÎ°ú ÎäòÎ¶¨Í≥† ÏóêÎü¨ Ï≤òÎ¶¨ Í∞úÏÑ†
                const controller = new AbortController();
                const timeoutId = setTimeout(() => {
                    console.log('‚è∞ ÌÉÄÏûÑÏïÑÏõÉÏúºÎ°ú ÏöîÏ≤≠ Ï∑®ÏÜå');
                    controller.abort();
                }, 5000); // 5Ï¥àÎ°ú Ï¶ùÍ∞Ä

                const response = await fetch(apiEndpoint, {
                    signal: controller.signal,
                    headers: {
                        'Cache-Control': 'no-cache'
                    }
                });
                clearTimeout(timeoutId);

                console.log(`üì° ÏùëÎãµ ÏÉÅÌÉú: ${response.status} ${response.statusText}`);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log(`‚úÖ API ÏùëÎãµ Î∞õÏùå:`, data);

                // ÌÇ§ÏõåÎìú Î∞∞Ïó¥ ÌôïÏù∏
                if (!data.keywords || !Array.isArray(data.keywords)) {
                    console.warn('ÌÇ§ÏõåÎìú Îç∞Ïù¥ÌÑ∞Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏùå, ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©');
                    throw new Error('ÌÇ§ÏõåÎìú Îç∞Ïù¥ÌÑ∞Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§');
                }

                // Ï∫êÏãúÏóê Ï†ÄÏû•
                dataCache[cacheKey] = data.keywords;
                console.log(`üíæ Ï∫êÏãú Ï†ÄÏû• ÏôÑÎ£å: ${cacheKey}`, data.keywords);

                if (loadingElement) {
                    loadingElement.classList.add('hidden');
                }
                displayWeekKeywords(keywordsContainer, data.keywords, weekNumber, region);
                console.log(`üé® ÌÇ§ÏõåÎìú ÌëúÏãú ÏôÑÎ£å: ${weekNumber}Ï£ºÏ∞® ${region}`);

            } catch (error) {
                console.error(`‚ùå ${weekNumber}Ï£ºÏ∞® ${region === 'global' ? 'Ìï¥Ïô∏' : 'Íµ≠ÎÇ¥'} ÌÇ§ÏõåÎìú Î°úÎî© Ïò§Î•ò:`, error);

                // ÎÇ†Ïßú Î≤îÏúÑ Ïû¨Ï†ïÏùò
                const weekDateRanges = {
                    1: { start: '2025-07-01', end: '2025-07-05' },
                    2: { start: '2025-07-06', end: '2025-07-13' },
                    3: { start: '2025-07-14', end: '2025-07-18' }
                };
                const { start: startDate, end: endDate } = weekDateRanges[weekNumber];

                const elementPrefix = region === 'global' ? 'global-' : '';
                const loadingElement = document.getElementById(`${elementPrefix}week${weekNumber}-loading`);

                // Îπ†Î•¥Í≤å ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î°ú ÎåÄÏ≤¥ (Ï¶âÏãú ÌëúÏãú)
                const sampleKeywords = getSampleKeywords(weekNumber, region);
                const keywordsContainer = document.getElementById(`${elementPrefix}week${weekNumber}-keywords`);

                // Ï∫êÏãúÏóê ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                const cacheKey = `${region}-${weekNumber}-${startDate}-${endDate}`;
                dataCache[cacheKey] = sampleKeywords;

                displayWeekKeywords(keywordsContainer, sampleKeywords, weekNumber, region);
                console.log(`üîÑ ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î°ú ÎåÄÏ≤¥: ${weekNumber}Ï£ºÏ∞® ${region}`, sampleKeywords);

                if (loadingElement) {
                    loadingElement.textContent = '‚úÖ Ï§ÄÎπÑ ÏôÑÎ£å (ÏÉòÌîå)';
                    loadingElement.style.color = '#28a745';
                    setTimeout(() => loadingElement.classList.add('hidden'), 1000);
                }
            }
        }

        // ÏÉòÌîå ÌÇ§ÏõåÎìú Îç∞Ïù¥ÌÑ∞ (Top5)
        function getSampleKeywords(weekNumber, region = 'domestic') {
            const domesticData = {
                1: ['Ï†ÑÍ∏∞Ï∞®', 'Î∞∞ÌÑ∞Î¶¨', 'Ï∂©Ï†ÑÏù∏ÌîÑÎùº', 'ÏûêÏú®Ï£ºÌñâ', 'ÌÖåÏä¨Îùº'],
                2: ['Î©îÌÉÄÎ≤ÑÏä§', 'VR', 'Í∞ÄÏÉÅÌòÑÏã§', 'AR', 'NFT'],
                3: ['Ïù∏Í≥µÏßÄÎä•', 'AI', 'ChatGPT', 'Î®∏Ïã†Îü¨Îãù', 'Îî•Îü¨Îãù']
            };

            const globalData = {
                1: ['Tesla', 'Apple', 'Microsoft', 'Google', 'Amazon'],
                2: ['ChatGPT', 'OpenAI', 'Meta', 'Twitter', 'TikTok'],
                3: ['NVIDIA', 'AMD', 'Intel', 'Samsung', 'TSMC']
            };

            const dataSource = region === 'global' ? globalData : domesticData;
            return dataSource[weekNumber] || ['ÌÇ§ÏõåÎìú1', 'ÌÇ§ÏõåÎìú2', 'ÌÇ§ÏõåÎìú3', 'ÌÇ§ÏõåÎìú4', 'ÌÇ§ÏõåÎìú5'];
        }

        // Ï£ºÏ∞®Î≥Ñ ÌÇ§ÏõåÎìú ÌëúÏãú (ÏµúÏ†ÅÌôî Î≤ÑÏ†Ñ)
        function displayWeekKeywords(container, keywords, weekNumber, region = 'domestic') {
            console.log(`üé® ÌÇ§ÏõåÎìú ÌëúÏãú ÏãúÏûë: ${weekNumber}Ï£ºÏ∞® ${region}`, { container, keywords });

            if (!container) {
                console.error(`‚ùå Ïª®ÌÖåÏù¥ÎÑàÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏùå: ${region === 'global' ? 'global-' : ''}week${weekNumber}-keywords`);
                return;
            }

            if (!keywords || !Array.isArray(keywords) || keywords.length === 0) {
                console.warn(`‚ö†Ô∏è ÌÇ§ÏõåÎìú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏùå: ${weekNumber}Ï£ºÏ∞® ${region}`);
                container.innerHTML = '<div class="keyword-tag">Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå</div>';
                return;
            }

            container.innerHTML = '';

            // Ï£ºÏ∞®Î≥Ñ ÎÇ†Ïßú Î≤îÏúÑ Îß§Ìïë
            const weekDateRanges = {
                1: { start: '2025-07-01', end: '2025-07-05' },
                2: { start: '2025-07-06', end: '2025-07-13' },
                3: { start: '2025-07-14', end: '2025-07-18' }
            };

            keywords.forEach((keyword, index) => {
                const keywordElement = document.createElement('div');
                keywordElement.className = 'keyword-tag'; // GPU Í∞ÄÏÜç ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
                keywordElement.textContent = keyword;

                // ÏßÄÏó≠Î≥Ñ Íµ¨Î∂ÑÏùÑ ÏúÑÌïú Îç∞Ïù¥ÌÑ∞ ÏÜçÏÑ± Ï∂îÍ∞Ä
                keywordElement.setAttribute('data-region', region);

                // Ï¶âÏãú ÌîºÎìúÎ∞± Ìö®Í≥º Ï†ÅÏö©
                applyInstantFeedback(keywordElement);

                // ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ - Í¥ÄÎ†® Í∏∞ÏÇ¨ ÌëúÏãú Î∞è ÌÇ§ÏõåÎìú Î∂ÑÏÑù (ÏßÄÏó≠ Ï†ïÎ≥¥ Ìè¨Ìï®)
                keywordElement.addEventListener('click', function (e) {
                    // Ï¶âÏãú ÏãúÍ∞ÅÏ†Å ÌîºÎìúÎ∞±
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);

                    selectedKeyword = keyword;
                    currentKeywords = [keyword];
                    const dateRange = weekDateRanges[weekNumber];

                    // Ï¶âÏãú Î°úÎî© ÏÉÅÌÉú ÌëúÏãú
                    showPreloadIndicator(`"${keyword}" Í¥ÄÎ†® Í∏∞ÏÇ¨ Í≤ÄÏÉâ Ï§ë...`);

                    // ÌÇ§ÏõåÎìú Î∂ÑÏÑù ÏàòÌñâ
                    performKeywordAnalysis(keyword);

                    // Ìï¥Îãπ Ï£ºÏ∞® ÎÇ†ÏßúÎ°ú Í¥ÄÎ†® Í∏∞ÏÇ¨ ÌëúÏãú (ÏßÄÏó≠ Ï†ïÎ≥¥ Ï†ÑÎã¨)
                    openArticleModal(keyword, dateRange, region);
                });

                // Ïï†ÎãàÎ©îÏù¥ÏÖò ÏßÄÏó∞ÏúºÎ°ú ÏàúÏ∞®Ï†Å Îì±Ïû• Ìö®Í≥º
                keywordElement.style.opacity = '0';
                keywordElement.style.transform = 'translateY(10px)';
                setTimeout(() => {
                    keywordElement.style.transition = 'all 0.3s ease';
                    keywordElement.style.opacity = '1';
                    keywordElement.style.transform = 'translateY(0)';
                }, index * 100); // 100msÏî© ÏßÄÏó∞

                container.appendChild(keywordElement);
            });
        }

        // ÌÇ§ÏõåÎìú ÏÑ†ÌÉù (ÌÅ¥Î¶≠Ïãú Í∏∞ÏÇ¨ Î≥¥Í∏∞, ÎçîÎ∏îÌÅ¥Î¶≠Ïãú Î∂ÑÏÑù) - ÏßÄÏó≠ Ï†ïÎ≥¥ Ìè¨Ìï®
        function selectKeyword(keyword, weekNumber, dateRange, region = 'domestic') {
            selectedKeyword = keyword;

            // ÌÇ§ÏõåÎìú ÌÉúÍ∑∏ ÌôúÏÑ±Ìôî ÌëúÏãú
            document.querySelectorAll('.keyword-tag').forEach(tag => {
                if (tag.textContent === keyword) {
                    tag.classList.add('selected');
                    tag.style.background = '#5A7DBC';
                    tag.style.color = '#FFFFFF';
                } else {
                    tag.classList.remove('selected');
                    tag.style.background = '#F0F2F5';
                    tag.style.color = '#555555';
                }
            });

            // ÎèôÏ†ÅÏúºÎ°ú Ï±óÎ¥á Ï†úÏïà ÏßàÎ¨∏ ÏóÖÎç∞Ïù¥Ìä∏
            updateChatSuggestions(keyword);

            // Ïã±Í∏Ä ÌÅ¥Î¶≠: Ìï¥Îãπ Ï£ºÏ∞® ÎÇ†ÏßúÎ°ú Í¥ÄÎ†® Í∏∞ÏÇ¨ ÌëúÏãú (ÏßÄÏó≠ Ï†ïÎ≥¥ Ï†ÑÎã¨)
            openArticleModal(keyword, dateRange, region);
        }

        // ÎèôÏ†Å ÌÇ§ÏõåÎìú Î∂ÑÏÑù Ìï®Ïàò
        async function performKeywordAnalysis(keyword) {
            try {
                const response = await fetch('/keyword-analysis', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ keyword: keyword })
                });

                const analysis = await response.json();

                if (analysis.error) {
                    console.error('Î∂ÑÏÑù Ïò§Î•ò:', analysis.error);
                    return;
                }

                // Ï±óÎ¥áÏóê Î∂ÑÏÑù Í≤∞Í≥º ÌëúÏãú
                displayAnalysisInChat(keyword, analysis);

            } catch (error) {
                console.error('ÌÇ§ÏõåÎìú Î∂ÑÏÑù Ï§ë Ïò§Î•ò:', error);
            }
        }

        // Ï±óÎ¥áÏóê Î∂ÑÏÑù Í≤∞Í≥º ÌëúÏãú
        function displayAnalysisInChat(keyword, analysis) {
            const chatHistory = document.getElementById('chat-history');
            if (!chatHistory) {
                console.error('Ï±óÎ¥á ÌûàÏä§ÌÜ†Î¶¨ ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§');
                return;
            }

            // ÏÇ¨Ïö©Ïûê Î©îÏãúÏßÄ Ï∂îÍ∞Ä
            const userMessage = document.createElement('div');
            userMessage.className = 'chat-message';
            userMessage.innerHTML = `<div class="chat-user"><strong>ÌÇ§ÏõåÎìú Î∂ÑÏÑù:</strong> ${keyword}</div>`;
            chatHistory.appendChild(userMessage);

            // AI ÏùëÎãµ - Îã®ÏàúÌôîÎêú Î∂ÑÏÑù Í≤∞Í≥º
            const analysisMessage = document.createElement('div');
            analysisMessage.className = 'chat-message';

            let analysisContent = '';
            if (analysis.analysis) {
                analysisContent = analysis.analysis;
            } else if (analysis.trend_summary) {
                analysisContent = analysis.trend_summary;
            } else {
                analysisContent = `${keyword}Ïóê ÎåÄÌïú Î∂ÑÏÑù Í≤∞Í≥ºÎ•º ÌëúÏãúÌï† Ïàò ÏóÜÏäµÎãàÎã§.`;
            }

            analysisMessage.innerHTML = `
                <div class="chat-bot">
                    <strong>üîç ${keyword} Î∂ÑÏÑù Í≤∞Í≥º</strong><br><br>
                    ${analysisContent}
                </div>
            `;
            chatHistory.appendChild(analysisMessage);

            // Ïä§ÌÅ¨Î°§ÏùÑ Í∞ÄÏû• ÏïÑÎûòÎ°ú
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }


        // ÌÇ§ÏõåÎìú ÎçîÎ∏îÌÅ¥Î¶≠Ïãú Î∂ÑÏÑù ÏÑ†ÌÉù Î™®Îìú
        document.addEventListener('dblclick', function (e) {
            if (e.target.classList.contains('keyword-tag')) {
                const keyword = e.target.textContent;
                selectedKeyword = keyword;

                // ÌÇ§ÏõåÎìú ÌôúÏÑ±Ìôî ÌëúÏãú
                document.querySelectorAll('.keyword-tag').forEach(tag => {
                    tag.style.background = tag.textContent === keyword
                        ? 'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)'
                        : 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                });

                // ÎèôÏ†ÅÏúºÎ°ú Ï±óÎ¥á Ï†úÏïà ÏßàÎ¨∏ ÏóÖÎç∞Ïù¥Ìä∏
                updateChatSuggestions(keyword);

                // ÌòÑÏû¨ ÌôúÏÑ±ÌôîÎêú ÏÇ∞ÏóÖ ÌÉ≠Ïóê ÎåÄÌïú Î∂ÑÏÑù Ïã§Ìñâ
                const activeTab = document.querySelector('.industry-tab.active');
                if (activeTab) {
                    loadIndustryAnalysis(activeTab.dataset.industry, keyword);
                }
            }
        });

        // ÏÇ∞ÏóÖÎ≥Ñ ÌÉ≠ ÏÑ§Ï†ï
        function setupIndustryTabs() {
            document.querySelectorAll('.industry-tab').forEach(tab => {
                tab.addEventListener('click', function () {
                    // ÌÉ≠ ÌôúÏÑ±Ìôî
                    document.querySelectorAll('.industry-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');

                    // ÏÑ†ÌÉùÎêú ÌÇ§ÏõåÎìúÍ∞Ä ÏûàÏúºÎ©¥ Î∂ÑÏÑù Ïã§Ìñâ
                    if (selectedKeyword) {
                        loadIndustryAnalysis(this.dataset.industry, selectedKeyword);
                    }
                });
            });
        }

        // Í∞úÏÑ†Îêú ÏÇ∞ÏóÖÎ≥Ñ Î∂ÑÏÑù Ìï®Ïàò (Ï†ïÎ∞òÎåÄ ÏùòÍ≤¨ Ìè¨Ìï®)
        async function loadIndustryAnalysis(industry, keyword) {
            const content = document.getElementById('analysis-content');
            content.innerHTML = '<div class="loading">ü§î Îã§ÏñëÌïú Í¥ÄÏ†êÏóêÏÑú Î∂ÑÏÑù Ï§ë...</div>';

            try {
                const response = await fetch('http://127.0.0.1:8000/industry-analysis', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        industry: industry,
                        keyword: keyword
                    })
                });

                const data = await response.json();
                content.innerHTML = `
                    <div class="analysis-grid">
                        <div class="analysis-section">
                            <div class="analysis-title">
                                <span style="color: #667eea;">üëç</span>
                                Í∏çÏ†ïÏ†Å/ÏùºÎ∞ò Î∂ÑÏÑù
                            </div>
                            <div style="line-height: 1.7;">${data.analysis}</div>
                        </div>
                        
                        <div class="counter-analysis-section">
                            <div class="counter-title">
                                <span style="color: #e74c3c;">ü§î</span>
                                ÎπÑÌåêÏ†Å/ÌöåÏùòÏ†Å Î∂ÑÏÑù
                            </div>
                            <div style="line-height: 1.7;">${data.counter_analysis || 'Î∞òÎåÄ ÏùòÍ≤¨ÏùÑ ÏÉùÏÑ±Ìï† Ïàò ÏóÜÏäµÎãàÎã§.'}</div>
                        </div>
                    </div>
                `;
            } catch (error) {
                content.innerHTML = `
                    <div style="color: #666; text-align: center; padding: 20px;">
                        ‚ùå Î∂ÑÏÑùÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.<br>
                        Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.
                    </div>
                `;
            }
        }

        // Í∏∞ÏÇ¨ Î™®Îã¨ Ìï®Ïàò (ÏµúÏ†ÅÌôî Î≤ÑÏ†Ñ)
        async function openArticleModal(keyword, dateRange = null, region = 'domestic') {
            const modal = document.getElementById('article-modal');
            const title = document.getElementById('modal-title');
            const articles = document.getElementById('modal-articles');

            // ÏßÄÏó≠ Ï†ïÎ≥¥Ïóê Îî∞Î•∏ ÌÉÄÏù¥ÌãÄ ÏÑ§Ï†ï
            const regionFlag = region === 'global' ? 'üåç' : 'üá∞üá∑';
            const regionText = region === 'global' ? 'Ìï¥Ïô∏' : 'Íµ≠ÎÇ¥';

            // ÎÇ†Ïßú Î≤îÏúÑ Ï†ïÎ≥¥ ÌëúÏãú
            const dateInfo = dateRange ? `(${dateRange.start} ~ ${dateRange.end})` : '';
            title.innerHTML = `<span style="color: #667eea;">${regionFlag}</span> "${keyword}" ${regionText} Í¥ÄÎ†® Top 5 Í∏∞ÏÇ¨ ${dateInfo}`;

            // Ï¶âÏãú Î™®Îã¨ ÌëúÏãú (Îπà ÏÉÅÌÉúÎ°ú)
            modal.style.display = 'block';
            articles.innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <div class="typing-dots" style="font-size: 18px; color: #5A7DBC;">
                        ‚ö° DeepSearch APIÎ°ú ÏµúÏã† Í∏∞ÏÇ¨Î•º Í≤ÄÏÉâ Ï§ë...
                    </div>
                    <div style="margin-top: 20px;">
                        <div class="skeleton skeleton-text"></div>
                        <div class="skeleton skeleton-text short"></div>
                        <div class="skeleton skeleton-text medium"></div>
                    </div>
                </div>
            `;

            // Ï∫êÏãú ÌÇ§ ÏÉùÏÑ±
            const cacheKey = `articles-${keyword}-${region}-${dateRange?.start || ''}-${dateRange?.end || ''}`;

            // Ï∫êÏãúÏóêÏÑú Î®ºÏ†Ä ÌôïÏù∏
            if (dataCache[cacheKey]) {
                displayArticles(articles, dataCache[cacheKey], regionText);
                hidePreloadIndicator();
                return;
            }

            try {
                // ÏßÄÏó≠Ïóê Îî∞Î•∏ API ÏóîÎìúÌè¨Ïù∏Ìä∏ ÏÑ†ÌÉù
                let baseUrl = region === 'global'
                    ? `http://127.0.0.1:8000/api/global-keyword-articles/${encodeURIComponent(keyword)}`
                    : `http://127.0.0.1:8000/keyword-articles?keyword=${encodeURIComponent(keyword)}`;

                // ÎÇ†Ïßú Î≤îÏúÑÍ∞Ä ÏûàÏúºÎ©¥ ÏøºÎ¶¨ ÌååÎùºÎØ∏ÌÑ∞Î°ú Ï†ÑÎã¨
                let url = baseUrl;
                if (dateRange) {
                    const separator = region === 'global' ? '?' : '&';
                    url += `${separator}start_date=${dateRange.start}&end_date=${dateRange.end}`;
                }

                console.log(`üì° ${regionText} API Ìò∏Ï∂ú:`, url);

                // Îπ†Î•∏ ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï (3Ï¥à)
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 3000);

                const response = await fetch(url, { signal: controller.signal });
                clearTimeout(timeoutId);

                const data = await response.json();

                // API ÏùëÎãµ Îç∞Ïù¥ÌÑ∞ ÎîîÎ≤ÑÍπÖ (URL ÌïÑÎìú ÌôïÏù∏)
                console.log(`üìä ${regionText} API ÏùëÎãµ:`, data);
                if (data.articles && data.articles.length > 0) {
                    console.log(`üîó ${regionText} Ï≤´ Î≤àÏß∏ Í∏∞ÏÇ¨ URL:`, data.articles[0].url);
                    console.log(`üìã ${regionText} URL ÌïÑÎìú ÌòÑÌô©:`, data.articles.map(article => ({
                        title: article.title?.substring(0, 50) + '...',
                        hasUrl: !!article.url,
                        url: article.url
                    })));
                }

                // Ï∫êÏãúÏóê Ï†ÄÏû•
                dataCache[cacheKey] = data;

                displayArticles(articles, data, regionText);

            } catch (error) {
                console.error('Í∏∞ÏÇ¨ Í≤ÄÏÉâ Ïò§Î•ò:', error);
                articles.innerHTML = `
                    <div style="color: #e74c3c; text-align: center; padding: 20px;">
                        <p>‚ùå Í¥ÄÎ†® Í∏∞ÏÇ¨Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.</p>
                        <p style="font-size: 14px; margin-top: 10px;">Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.</p>
                        <button onclick="openArticleModal('${keyword}', ${JSON.stringify(dateRange)}, '${region}')" 
                                style="margin-top: 15px; padding: 8px 16px; background: #5A7DBC; color: white; border: none; border-radius: 6px; cursor: pointer;">
                            Îã§Ïãú ÏãúÎèÑ
                        </button>
                    </div>
                `;
            }

            hidePreloadIndicator();
        }

        // Í∏∞ÏÇ¨ ÌëúÏãú Ìï®Ïàò
        function displayArticles(articlesContainer, data, regionText) {
            articlesContainer.innerHTML = '';

            if (data.articles && data.articles.length > 0) {
                const articlesGrid = document.createElement('div');
                articlesGrid.className = 'articles-grid';

                data.articles.forEach((article, index) => {
                    const card = document.createElement('div');
                    const articleHasValidUrl = article.url && article.url.trim() && article.url !== 'null' && article.url !== 'undefined';

                    // URL ÏÉÅÌÉúÏóê Îî∞Î•∏ ÌÅ¥ÎûòÏä§ ÏÑ§Ï†ï
                    card.className = articleHasValidUrl ? 'article-card quick-hover' : 'article-card no-url';
                    if (articleHasValidUrl) {
                        card.style.cursor = 'pointer';
                    }

                    // Ï¶âÏãú ÌîºÎìúÎ∞± Ìö®Í≥º Ï†ÅÏö© (URLÏù¥ ÏûàÎäî Í≤ΩÏö∞Îßå)
                    if (articleHasValidUrl) {
                        applyInstantFeedback(card);
                    }

                    // ÎÇ†Ïßú Ìè¨Îß∑ Í∞úÏÑ† + URL ÏÉÅÌÉú ÌëúÏãú
                    const displayDate = article.date || article.published_at || 'ÎÇ†Ïßú Ï†ïÎ≥¥ ÏóÜÏùå';
                    const dateColor = '#6c757d';

                    // URL ÏÉÅÌÉú ÏïÑÏù¥ÏΩò
                    const urlIcon = articleHasValidUrl ? 'üîó' : 'üö´';
                    const urlStatus = articleHasValidUrl ? 'ÌÅ¥Î¶≠ÌïòÏó¨ ÏõêÎ¨∏ Î≥¥Í∏∞' : 'ÏõêÎ¨∏ ÎßÅÌÅ¨ ÏóÜÏùå';
                    const urlColor = articleHasValidUrl ? '#28a745' : '#dc3545';

                    card.innerHTML = `
                        <div class="article-date" style="color: ${dateColor};">
                            ${displayDate}
                            <span style="color: ${urlColor}; margin-left: 8px; font-size: 12px;" title="${urlStatus}">
                                ${urlIcon}
                            </span>
                        </div>
                        <div class="article-title">${article.title}</div>
                        <div class="article-summary">${article.summary || article.content || 'ÏöîÏïΩ Ï†ïÎ≥¥ ÏóÜÏùå'}</div>
                        ${articleHasValidUrl ?
                            '<div style="font-size: 11px; color: #28a745; margin-top: 8px; font-weight: 500;">‚ñ∂ ÌÅ¥Î¶≠ÌïòÏó¨ ÏõêÎ¨∏ Î≥¥Í∏∞</div>' :
                            '<div style="font-size: 11px; color: #dc3545; margin-top: 8px;">‚ö† ÏõêÎ¨∏ ÎßÅÌÅ¨Í∞Ä Ï†úÍ≥µÎêòÏßÄ ÏïäÏäµÎãàÎã§</div>'
                        }
                    `;

                    // Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(10px)';
                    setTimeout(() => {
                        card.style.transition = 'all 0.3s ease';
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, index * 100);

                    // Í∏∞ÏÇ¨ ÌÅ¥Î¶≠Ïãú ÏõêÎ≥∏ URLÎ°ú Ïù¥Îèô (Ìï¥Ïô∏/Íµ≠ÎÇ¥ Íµ¨Î∂Ñ Í∞ïÌôî)
                    card.addEventListener('click', () => {
                        console.log(`üîó Í∏∞ÏÇ¨ ÌÅ¥Î¶≠ - ÏßÄÏó≠: ${regionText}, URL: ${article.url || 'ÏóÜÏùå'}`, article);

                        if (article.url && article.url.trim() && article.url !== 'null' && article.url !== 'undefined') {
                            // Ï¶âÏãú ÏãúÍ∞ÅÏ†Å ÌîºÎìúÎ∞±
                            card.style.transform = 'scale(0.98)';
                            card.style.backgroundColor = '#e8f5e8';

                            // URL Ïú†Ìö®ÏÑ± Ï∂îÍ∞Ä Ï≤¥ÌÅ¨
                            const url = article.url.startsWith('http') ? article.url : `https://${article.url}`;

                            setTimeout(() => {
                                window.open(url, '_blank');
                                card.style.transform = '';
                                card.style.backgroundColor = '';
                                console.log(`‚úÖ ${regionText} Í∏∞ÏÇ¨ Ïó¥Î¶º: ${url}`);
                            }, 100);
                        } else {
                            // URLÏù¥ ÏóÜÎäî Í≤ΩÏö∞ ÏãúÍ∞ÅÏ†Å ÌîºÎìúÎ∞±
                            card.style.backgroundColor = '#ffebee';
                            setTimeout(() => {
                                card.style.backgroundColor = '';
                            }, 1000);

                            console.warn(`‚ùå ${regionText} Í∏∞ÏÇ¨ URLÏù¥ ÏóÜÏäµÎãàÎã§:`, article);

                            // ÏÇ¨Ïö©ÏûêÏóêÍ≤å ÏïåÎ¶º
                            const notification = document.createElement('div');
                            notification.style.cssText = `
                                position: fixed; top: 20px; right: 20px; 
                                background: #ff5252; color: white; padding: 12px 20px; 
                                border-radius: 8px; font-size: 14px; z-index: 10000;
                                box-shadow: 0 4px 12px rgba(255, 82, 82, 0.3);
                            `;
                            notification.innerHTML = `‚ö†Ô∏è ${regionText} Í∏∞ÏÇ¨ ÎßÅÌÅ¨Í∞Ä ÏóÜÏäµÎãàÎã§`;
                            document.body.appendChild(notification);

                            setTimeout(() => {
                                notification.remove();
                            }, 3000);
                        }
                    });

                    articlesGrid.appendChild(card);
                });

                articlesContainer.appendChild(articlesGrid);

                // DeepSearch API ÏÇ¨Ïö© ÏïåÎ¶º Ï∂îÍ∞Ä
                const apiInfo = document.createElement('div');
                apiInfo.style.cssText = `
                    text-align: center; 
                    color: #28a745; 
                    font-size: 12px; 
                    margin-top: 15px; 
                    padding: 10px;
                    background: #f8f9fa;
                    border-radius: 6px;
                    border-left: 4px solid #28a745;
                `;
                apiInfo.innerHTML = `‚úÖ DeepSearch APIÎ•º ÌÜµÌï¥ ÏµúÏã† Í∏∞ÏÇ¨Î•º Í∞ÄÏ†∏ÏôîÏäµÎãàÎã§. (${data.articles.length}Í∞ú)`;
                articlesContainer.appendChild(apiInfo);
            } else {
                articlesContainer.innerHTML = `
                    <div style="text-align: center; color: #666; padding: 20px;">
                        <p>Ìï¥Îãπ ÌÇ§ÏõåÎìúÏôÄ Í¥ÄÎ†®Îêú Í∏∞ÏÇ¨Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.</p>
                        <p style="font-size: 14px; margin-top: 10px; color: #999;">Îã§Î•∏ ÌÇ§ÏõåÎìúÎ°ú ÏãúÎèÑÌï¥Î≥¥ÏÑ∏Ïöî.</p>
                    </div>
                `;
            }
        }

        // üöÄ ÏµúÏ†ÅÌôîÎêú Í∏∞ÏÇ¨ Î™®Îã¨ (Ï¶âÏãú Î°úÎî© + Ï∫êÏã±)
        async function openArticleModalOptimized(keyword, dateRange = null, region = 'domestic') {
            const modal = document.getElementById('article-modal');
            const title = document.getElementById('modal-title');
            const articles = document.getElementById('modal-articles');

            // Ï∫êÏãú ÌÇ§ ÏÉùÏÑ±
            const cacheKey = `articles-${keyword}-${region}-${dateRange?.start}-${dateRange?.end}`;

            // Ï¶âÏãú Î™®Îã¨ ÌëúÏãú (Îπ†Î•∏ ÌîºÎìúÎ∞±)
            const regionFlag = region === 'global' ? 'üåç' : 'üá∞üá∑';
            const regionText = region === 'global' ? 'Ìï¥Ïô∏' : 'Íµ≠ÎÇ¥';
            const dateInfo = dateRange ? `(${dateRange.start} ~ ${dateRange.end})` : '';

            title.innerHTML = `<span style="color: #667eea;">${regionFlag}</span> "${keyword}" ${regionText} Í¥ÄÎ†® Í∏∞ÏÇ¨ ${dateInfo}`;
            modal.style.display = 'block';
            modal.style.animation = 'fadeInFast 0.2s ease';

            // Ï∫êÏãú ÌôïÏù∏ (Ï¶âÏãú ÌëúÏãú)
            if (dataCache.has(cacheKey)) {
                performanceMetrics.cacheHits++;
                console.log(`‚ö° Í∏∞ÏÇ¨ Ï∫êÏãú Ï†ÅÏ§ë: ${keyword}`);

                articles.innerHTML = '<div style="text-align: center; color: #10b981; padding: 20px;">‚ö° Ï∫êÏãúÎêú Îç∞Ïù¥ÌÑ∞ (Ï¶âÏãú Î°úÎî©)</div>';
                setTimeout(() => {
                    displayCachedArticles(articles, dataCache.get(cacheKey), regionFlag, regionText);
                }, 200);
                return;
            }

            // Î°úÎî© ÏÉÅÌÉú ÌëúÏãú
            articles.innerHTML = `
                <div class="fast-loading" style="text-align: center; padding: 30px;">
                    <div class="typing-dots">üîç ${regionText} ÏµúÏã† Í∏∞ÏÇ¨ Í≤ÄÏÉâ Ï§ë...</div>
                    <div style="font-size: 12px; margin-top: 10px; color: #666;">
                        DeepSearch API Í≥†ÏÜç Í≤ÄÏÉâ
                    </div>
                </div>
            `;

            try {
                performanceMetrics.totalRequests++;
                const startTime = Date.now();

                // API Ìò∏Ï∂ú
                let baseUrl = region === 'global'
                    ? `http://127.0.0.1:8000/api/global-keyword-articles/${encodeURIComponent(keyword)}`
                    : `http://127.0.0.1:8000/keyword-articles?keyword=${encodeURIComponent(keyword)}`;

                let url = baseUrl;
                if (dateRange) {
                    const separator = region === 'global' ? '?' : '&';
                    url += `${separator}start_date=${dateRange.start}&end_date=${dateRange.end}`;
                }

                console.log(`üì° ${regionText} API Ìò∏Ï∂ú:`, url);
                const response = await fetch(url, {
                    timeout: 5000 // 5Ï¥à ÌÉÄÏûÑÏïÑÏõÉ
                });
                const data = await response.json();

                const elapsed = Date.now() - startTime;
                console.log(`‚ö° API ÏùëÎãµÏãúÍ∞Ñ: ${elapsed}ms`);

                // Ï∫êÏãúÏóê Ï†ÄÏû•
                if (data.articles && data.articles.length > 0) {
                    dataCache.set(cacheKey, data.articles);
                }

                // Í∏∞ÏÇ¨ ÌëúÏãú
                displayArticlesOptimized(articles, data.articles, regionFlag, regionText, elapsed);

            } catch (error) {
                console.error('Í∏∞ÏÇ¨ Í≤ÄÏÉâ Ïò§Î•ò:', error);
                articles.innerHTML = `
                    <div style="color: #e74c3c; text-align: center; padding: 20px;">
                        <p>‚ùå Í¥ÄÎ†® Í∏∞ÏÇ¨Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.</p>
                        <p style="font-size: 14px; margin-top: 10px;">Ïò§Î•ò: ${error.message}</p>
                        <button onclick="openArticleModalOptimized('${keyword}', ${JSON.stringify(dateRange)}, '${region}')" 
                                style="margin-top: 15px; padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            ‚ü≤ Îã§Ïãú ÏãúÎèÑ
                        </button>
                    </div>
                `;
            }
        }

        // Ï∫êÏãúÎêú Í∏∞ÏÇ¨ ÌëúÏãú
        function displayCachedArticles(articlesContainer, articles, regionFlag, regionText) {
            displayArticlesOptimized(articlesContainer, articles, regionFlag, regionText, 0, true);
        }

        // üöÄ ÏµúÏ†ÅÌôîÎêú Í∏∞ÏÇ¨ ÌëúÏãú (Ïï†ÎãàÎ©îÏù¥ÏÖò + ÏÑ±Îä• Ïù∏ÎîîÏºÄÏù¥ÌÑ∞)
        function displayArticlesOptimized(articlesContainer, articles, regionFlag, regionText, responseTime = 0, fromCache = false) {
            articlesContainer.innerHTML = '';

            if (articles && articles.length > 0) {
                const articlesGrid = document.createElement('div');
                articlesGrid.className = 'articles-grid';

                articles.forEach((article, index) => {
                    setTimeout(() => {
                        const card = document.createElement('div');
                        const articleHasValidUrl = article.url && article.url.trim() && article.url !== 'null' && article.url !== 'undefined';

                        // URL ÏÉÅÌÉúÏóê Îî∞Î•∏ ÌÅ¥ÎûòÏä§ ÏÑ§Ï†ï
                        card.className = articleHasValidUrl ? 'article-card instant-feedback quick-hover' : 'article-card no-url';
                        if (articleHasValidUrl) {
                            card.style.cursor = 'pointer';
                        }
                        card.style.opacity = '0';
                        card.style.transform = 'translateY(20px)';

                        const displayDate = article.date || article.published_at || 'ÎÇ†Ïßú Ï†ïÎ≥¥ ÏóÜÏùå';

                        // URL ÏÉÅÌÉú ÌëúÏãú
                        const urlIcon = articleHasValidUrl ? 'üîó' : 'üö´';
                        const urlStatus = articleHasValidUrl ? 'ÌÅ¥Î¶≠ÌïòÏó¨ ÏõêÎ¨∏ Î≥¥Í∏∞' : 'ÏõêÎ¨∏ ÎßÅÌÅ¨ ÏóÜÏùå';
                        const urlColor = articleHasValidUrl ? '#28a745' : '#dc3545';

                        card.innerHTML = `
                            <div class="article-date" style="color: #6c757d;">
                                ${displayDate}
                                ${fromCache ? '<span style="color: #10b981; margin-left: 8px;">‚ö° Ï∫êÏãú</span>' : ''}
                                <span style="color: ${urlColor}; margin-left: 8px; font-size: 12px;" title="${urlStatus}">
                                    ${urlIcon}
                                </span>
                            </div>
                            <div class="article-title">${article.title}</div>
                            <div class="article-summary">${article.summary || article.content || 'ÏöîÏïΩ Ï†ïÎ≥¥ ÏóÜÏùå'}</div>
                            ${articleHasValidUrl ?
                                '<div style="font-size: 11px; color: #28a745; margin-top: 8px; font-weight: 500;">‚ñ∂ ÌÅ¥Î¶≠ÌïòÏó¨ ÏõêÎ¨∏ Î≥¥Í∏∞</div>' :
                                '<div style="font-size: 11px; color: #dc3545; margin-top: 8px;">‚ö† ÏõêÎ¨∏ ÎßÅÌÅ¨Í∞Ä Ï†úÍ≥µÎêòÏßÄ ÏïäÏäµÎãàÎã§</div>'
                            }
                        `;

                        // ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ (Ï¶âÏãú ÌîºÎìúÎ∞± + Ìï¥Ïô∏/Íµ≠ÎÇ¥ URL Ï≤òÎ¶¨ Í∞ïÌôî)
                        card.addEventListener('click', () => {
                            console.log(`üîó ${regionText} Í∏∞ÏÇ¨ ÌÅ¥Î¶≠ - URL: ${article.url || 'ÏóÜÏùå'}`, article);

                            if (articleHasValidUrl) {
                                card.style.transform = 'scale(0.98)';
                                card.style.backgroundColor = '#f0fdfc';

                                // URL Ïú†Ìö®ÏÑ± Ï∂îÍ∞Ä Ï≤¥ÌÅ¨
                                const url = article.url.startsWith('http') ? article.url : `https://${article.url}`;

                                setTimeout(() => {
                                    window.open(url, '_blank');
                                    card.style.transform = '';
                                    card.style.backgroundColor = '';
                                    console.log(`‚úÖ ${regionText} Í∏∞ÏÇ¨ Ïó¥Î¶º: ${url}`);
                                }, 150);
                            } else {
                                // URLÏù¥ ÏóÜÎäî Í≤ΩÏö∞ Îçî Î™ÖÌôïÌïú ÌîºÎìúÎ∞±
                                card.style.backgroundColor = '#ffebee';
                                card.style.borderLeft = '4px solid #ff5252';

                                setTimeout(() => {
                                    card.style.backgroundColor = '';
                                    card.style.borderLeft = '4px solid #5A7DBC';
                                }, 2000);

                                console.warn(`‚ùå ${regionText} Í∏∞ÏÇ¨ URLÏù¥ ÏóÜÏäµÎãàÎã§:`, article);

                                // Ìñ•ÏÉÅÎêú ÏÇ¨Ïö©Ïûê ÏïåÎ¶º
                                const notification = document.createElement('div');
                                notification.style.cssText = `
                                    position: fixed; top: 50%; left: 50%; 
                                    transform: translate(-50%, -50%);
                                    background: white; color: #333; padding: 20px 30px; 
                                    border-radius: 12px; font-size: 14px; z-index: 10000;
                                    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
                                    border-left: 4px solid #ff5252;
                                `;
                                notification.innerHTML = `
                                    <div style="font-weight: 600; margin-bottom: 8px;">‚ö†Ô∏è ÎßÅÌÅ¨ Ï†ïÎ≥¥ ÏóÜÏùå</div>
                                    <div>Ïù¥ ${regionText} Í∏∞ÏÇ¨Îäî ÏõêÎ≥∏ ÎßÅÌÅ¨Í∞Ä Ï†úÍ≥µÎêòÏßÄ ÏïäÏäµÎãàÎã§.</div>
                                `;
                                document.body.appendChild(notification);

                                setTimeout(() => {
                                    notification.style.opacity = '0';
                                    setTimeout(() => notification.remove(), 300);
                                }, 3000);
                            }
                        });

                        articlesGrid.appendChild(card);

                        // Î∂ÄÎìúÎü¨Ïö¥ Îì±Ïû• Ïï†ÎãàÎ©îÏù¥ÏÖò
                        requestAnimationFrame(() => {
                            card.style.transition = 'all 0.3s ease';
                            card.style.opacity = '1';
                            card.style.transform = 'translateY(0)';
                        });

                    }, index * 50); // 50ms Í∞ÑÍ≤©ÏúºÎ°ú ÏàúÏ∞® Îì±Ïû•
                });

                articlesContainer.appendChild(articlesGrid);

                // ÏÑ±Îä• Ï†ïÎ≥¥ ÌëúÏãú
                const performanceInfo = document.createElement('div');
                performanceInfo.style.cssText = `
                    text-align: center; 
                    color: ${fromCache ? '#10b981' : '#28a745'}; 
                    font-size: 12px; 
                    margin-top: 15px; 
                    padding: 10px;
                    background: ${fromCache ? '#f0fdf4' : '#f8f9fa'};
                    border-radius: 6px;
                    border-left: 4px solid ${fromCache ? '#10b981' : '#28a745'};
                `;

                const cacheRate = ((performanceMetrics.cacheHits / performanceMetrics.totalRequests) * 100).toFixed(1);
                performanceInfo.innerHTML = fromCache
                    ? `‚ö° Ï∫êÏãúÏóêÏÑú Ï¶âÏãú Î°úÎìúÎê® (${articles.length}Í∞ú) | Ï∫êÏãú Ï†ÅÏ§ëÎ•†: ${cacheRate}%`
                    : `‚úÖ DeepSearch API ÏùëÎãµ (${responseTime}ms, ${articles.length}Í∞ú) | Ï∫êÏãú Ï†ÅÏ§ëÎ•†: ${cacheRate}%`;

                articlesContainer.appendChild(performanceInfo);

            } else {
                articlesContainer.innerHTML = `
                    <div style="text-align: center; color: #666; padding: 20px;">
                        <p>Ìï¥Îãπ ÌÇ§ÏõåÎìúÏôÄ Í¥ÄÎ†®Îêú Í∏∞ÏÇ¨Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.</p>
                        <p style="font-size: 14px; margin-top: 10px; color: #999;">Îã§Î•∏ ÌÇ§ÏõåÎìúÎ°ú ÏãúÎèÑÌï¥Î≥¥ÏÑ∏Ïöî.</p>
                    </div>
                `;
            }
        }

        // Î™®Îã¨ Îã´Í∏∞ (Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º)
        function closeModal() {
            const modal = document.getElementById('article-modal');
            modal.style.animation = 'fadeOut 0.2s ease';
            setTimeout(() => {
                modal.style.display = 'none';
                modal.style.animation = '';
            }, 200);
        }

        // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠Ïãú Îã´Í∏∞
        window.onclick = function (event) {
            const modal = document.getElementById('article-modal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Ï†úÏïà ÏßàÎ¨∏ ÌÅ¥Î¶≠ Í∏∞Îä•
        function sendSuggestion(suggestionText) {
            const chatInput = document.getElementById('chat-input');
            chatInput.value = suggestionText;
            sendChat();
        }

        // ÌÇ§ÏõåÎìú Í∏∞Î∞ò ÎèôÏ†Å Ï†úÏïà ÏßàÎ¨∏ ÏóÖÎç∞Ïù¥Ìä∏
        function updateChatSuggestions(keyword) {
            const suggestionsContainer = document.querySelector('.suggestions-container');

            // ÌÇ§ÏõåÎìúÎ≥Ñ ÎèôÏ†Å Ï†úÏïà ÏßàÎ¨∏ ÏÉùÏÑ±
            const suggestions = [
                `${keyword}Ïùò ÏÇ¨ÌöåÏ†Å ÏòÅÌñ•ÏùÄ?`,
                `${keyword} ÏãúÏû• Í≤ΩÏ†ú Ï†ÑÎßùÏùÄ?`,
                `${keyword} ÏµúÍ∑º Í∏∞ÏóÖ ÎèôÌñ•ÏùÄ?`,
                `${keyword} Í∏∞Ïà† Î∞úÏ†Ñ Î∞©Ìñ•ÏùÄ?`
            ];

            // Í∏∞Ï°¥ Ï†úÏïà ÏßàÎ¨∏ Ï†úÍ±∞
            suggestionsContainer.innerHTML = '';

            // ÏÉàÎ°úÏö¥ Ï†úÏïà ÏßàÎ¨∏ Ï∂îÍ∞Ä
            suggestions.forEach(suggestion => {
                const suggestionItem = document.createElement('div');
                suggestionItem.className = 'suggestion-item';
                suggestionItem.textContent = suggestion;
                suggestionItem.onclick = () => sendSuggestion(suggestion);
                suggestionsContainer.appendChild(suggestionItem);
            });

            // Ï†úÏïà ÏßàÎ¨∏ Ïª®ÌÖåÏù¥ÎÑà Í∞ïÏ°∞ Ìö®Í≥º
            suggestionsContainer.style.animation = 'pulse 0.5s ease-in-out';
            setTimeout(() => {
                suggestionsContainer.style.animation = '';
            }, 500);
        }

        // Ï¥àÍ∏∞ Ï†úÏïà ÏßàÎ¨∏ ÏÑ§Ï†ï
        function initializeChatSuggestions() {
            const defaultSuggestions = [
                'Ïù∏Í≥µÏßÄÎä•Ïùò ÏÇ¨ÌöåÏ†Å ÏòÅÌñ•ÏùÄ?',
                'Î∞òÎèÑÏ≤¥ ÏãúÏû• Í≤ΩÏ†ú Ï†ÑÎßùÏùÄ?',
                'AI vs Î∞òÎèÑÏ≤¥ ÎπÑÍµê',
                'ÏµúÍ∑º Í∏∞ÏóÖ ÎèôÌñ•ÏùÄ?'
            ];

            const suggestionsContainer = document.querySelector('.suggestions-container');
            suggestionsContainer.innerHTML = '';

            defaultSuggestions.forEach(suggestion => {
                const suggestionItem = document.createElement('div');
                suggestionItem.className = 'suggestion-item';
                suggestionItem.textContent = suggestion;
                suggestionItem.onclick = () => sendSuggestion(suggestion);
                suggestionsContainer.appendChild(suggestionItem);
            });
        }

        // Ï±óÎ¥á Í∏∞Îä• (ÏµúÏ†ÅÌôî Î≤ÑÏ†Ñ)
        async function sendChat() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();

            if (!message) return;

            // Ï¶âÏãú UI ÏóÖÎç∞Ïù¥Ìä∏ (Îπ†Î•∏ Î∞òÏùë)
            addChatMessage(message, 'user');
            input.value = '';

            // Ï†ÑÏÜ° Î≤ÑÌäº Ï¶âÏãú ÎπÑÌôúÏÑ±Ìôî
            const sendBtn = document.getElementById('chat-send');
            sendBtn.disabled = true;
            sendBtn.textContent = '‚ö° Î∂ÑÏÑù Ï§ë...';
            sendBtn.style.background = '#6C757D';

            // Ï¶âÏãú ÌÉÄÏù¥Ìïë Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ Ï∂îÍ∞Ä
            const typingIndicator = addTypingIndicator();

            try {
                // Îπ†Î•∏ ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï (5Ï¥à)
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000);

                const response = await fetch('http://127.0.0.1:8000/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ question: message }),
                    signal: controller.signal
                });

                clearTimeout(timeoutId);
                const data = await response.json();

                // ÌÉÄÏù¥Ìïë Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ Ï†úÍ±∞
                typingIndicator.remove();

                // ÎãµÎ≥Ä Ï∂îÍ∞Ä (ÎßàÌÅ¨Îã§Ïö¥ Ïä§ÌÉÄÏùº Ï†ÅÏö©)
                addChatMessage(data.answer || 'Ï£ÑÏÜ°Ìï©ÎãàÎã§. ÎãµÎ≥ÄÏùÑ ÏÉùÏÑ±Ìï† Ïàò ÏóÜÏäµÎãàÎã§.', 'bot');

            } catch (error) {
                console.error('Chat error:', error);
                typingIndicator.remove();

                const errorMessage = error.name === 'AbortError'
                    ? '‚è∞ ÏùëÎãµ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.'
                    : 'üîÑ ÏÑúÎ≤ÑÏôÄÏùò Ïó∞Í≤∞Ïóê Î¨∏Ï†úÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';

                addChatMessage(errorMessage, 'bot');
            } finally {
                // Ï†ÑÏÜ° Î≤ÑÌäº Î≥µÍµ¨
                sendBtn.disabled = false;
                sendBtn.textContent = 'Ï†ÑÏÜ°';
                sendBtn.style.background = '#5A7DBC';
            }
        }

        // ÌÉÄÏù¥Ìïë Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ Ï∂îÍ∞Ä (ÏµúÏ†ÅÌôî)
        function addTypingIndicator() {
            const chatHistory = document.getElementById('chat-history');
            const typingMessage = document.createElement('div');
            typingMessage.className = 'chat-message typing-message';
            typingMessage.innerHTML = `
                <div class="chat-bot typing-dots" style="background: #E9ECEF; animation: pulse 1s infinite;">
                    ‚ö° AIÍ∞Ä Î∂ÑÏÑù Ï§ëÏûÖÎãàÎã§...
                </div>
            `;
            chatHistory.appendChild(typingMessage);
            chatHistory.scrollTop = chatHistory.scrollHeight;
            return typingMessage;
        }

        // Ï±ÑÌåÖ Î©îÏãúÏßÄ Ï∂îÍ∞Ä (ÏµúÏ†ÅÌôî)
        function addChatMessage(message, sender) {
            const chatHistory = document.getElementById('chat-history');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'chat-message';

            const messageClass = sender === 'user' ? 'chat-user' : 'chat-bot';
            const messageContent = document.createElement('div');
            messageContent.className = messageClass;
            messageContent.innerHTML = message;

            // Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º
            messageContent.style.opacity = '0';
            messageContent.style.transform = 'translateY(10px)';

            messageDiv.appendChild(messageContent);
            chatHistory.appendChild(messageDiv);

            // Î∂ÄÎìúÎü¨Ïö¥ Îì±Ïû• Ïï†ÎãàÎ©îÏù¥ÏÖò
            setTimeout(() => {
                messageContent.style.transition = 'all 0.3s ease';
                messageContent.style.opacity = '1';
                messageContent.style.transform = 'translateY(0)';
            }, 50);

            // Ïä§ÌÅ¨Î°§ÏùÑ Í∞ÄÏû• ÏïÑÎûòÎ°ú (Î∂ÄÎìúÎüΩÍ≤å)
            chatHistory.scrollTo({
                top: chatHistory.scrollHeight,
                behavior: 'smooth'
            });
        }

        // Ï†ÑÏÜ° Î≤ÑÌäº Îã§Ïãú ÌôúÏÑ±Ìôî Ìï®Ïàò
        function enableSendButton() {
            const sendBtn = document.getElementById('chat-send-btn');
            if (sendBtn) {
                sendBtn.disabled = false;
                sendBtn.textContent = 'Ï†ÑÏÜ°';
            }
        }

        function addTypingIndicator() {
            const chatHistory = document.getElementById('chat-history');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'chat-message';
            typingDiv.id = 'typing-indicator';

            const typingContent = document.createElement('div');
            typingContent.className = 'chat-bot';
            typingContent.innerHTML = 'ü§î Î∂ÑÏÑù Ï§ë<span class="typing-dots">...</span>';
            typingContent.style.fontStyle = 'italic';

            typingDiv.appendChild(typingContent);
            chatHistory.appendChild(typingDiv);

            // Ïä§ÌÅ¨Î°§ÏùÑ Îß® ÏïÑÎûòÎ°ú
            chatHistory.scrollTop = chatHistory.scrollHeight;

            return typingDiv;
        }

        function addChatMessage(message, sender) {
            const chatHistory = document.getElementById('chat-history');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'chat-message';

            const messageContent = document.createElement('div');
            messageContent.className = sender === 'user' ? 'chat-user' : 'chat-bot';

            // Î¥á Î©îÏãúÏßÄÏùò Í≤ΩÏö∞ Ï§ÑÎ∞îÍøà Ï≤òÎ¶¨
            if (sender === 'bot') {
                messageContent.innerHTML = message.replace(/\n/g, '<br>');
            } else {
                messageContent.textContent = message;
            }

            messageDiv.appendChild(messageContent);
            chatHistory.appendChild(messageDiv);

            // Ïä§ÌÅ¨Î°§ÏùÑ Îß® ÏïÑÎûòÎ°ú
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        // Ï±óÎ¥á Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑàÎäî ÏúÑ DOMContentLoaded ÏóêÏÑú ÌÜµÌï© Ï≤òÎ¶¨Îê®

        // üöÄ Ï¥àÍ≥†ÏÜç Í≤ÄÏÉâ Ìï®Ïàò (Î©îÏù∏ Í≤ÄÏÉâ)
        async function performOptimizedSearch() {
            try {
                // Ï¶âÏãú ÏãúÍ∞ÅÏ†Å ÌîºÎìúÎ∞±
                showSkeletonUI();
                showPerformanceBadge('‚ö° Ï¥àÍ≥†ÏÜç Í≤ÄÏÉâ ÏãúÏûë');

                const query = document.getElementById('search').value;
                if (!query.trim()) {
                    alert('Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                    hideSkeletonUI();
                    return;
                }

                // Ï∫êÏãú ÌôïÏù∏ (0.1Ï¥à Ïù¥ÎÇ¥)
                const cacheKey = `search_${query}`;
                if (performanceCache.has(cacheKey)) {
                    const cachedData = performanceCache.get(cacheKey);
                    displayResults(cachedData.results);
                    hideSkeletonUI();
                    showPerformanceBadge('üí® Ï∫êÏãúÏóêÏÑú Ï¥àÍ≥†ÏÜç Î°úÎî©!');
                    return;
                }

                // API Ìò∏Ï∂ú
                const response = await fetch('/search', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ query: query })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                // Í≤∞Í≥º Ï∫êÏã±
                performanceCache.set(cacheKey, { results: data, timestamp: Date.now() });

                // Í≤∞Í≥º ÌëúÏãú
                displayResults(data);
                hideSkeletonUI();
                showPerformanceBadge('‚úÖ Í≤ÄÏÉâ ÏôÑÎ£å!');

            } catch (error) {
                console.error('Í≤ÄÏÉâ Ïò§Î•ò:', error);
                hideSkeletonUI();
                showPerformanceBadge('‚ùå Í≤ÄÏÉâ Ïò§Î•ò Î∞úÏÉù');
                document.getElementById('results').innerHTML = '<p>Í≤ÄÏÉâ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.</p>';
            }
        }

        // üí´ Î™®Îã¨ ÌéòÏù¥ÎìúÏïÑÏõÉ Ïï†ÎãàÎ©îÏù¥ÏÖò
        function closeModalWithAnimation(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.opacity = '0';
                modal.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    modal.style.display = 'none';
                    modal.style.opacity = '1';
                    modal.style.transform = 'scale(1)';
                }, 300);
            }
        }
    </script>

    <!-- Íµ¨ÎèÖ Î™®Îã¨ -->
    <div id="subscribeModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSubscribeModal()">&times;</span>
            <h2>üìß Ï£ºÍ∞Ñ Ïù∏ÏÇ¨Ïù¥Ìä∏ Íµ¨ÎèÖ</h2>
            <p>AIÍ∞Ä Î∂ÑÏÑùÌïú Ï£ºÍ∞Ñ ÌÇ§ÏõåÎìú Ìä∏Î†åÎìúÏôÄ Ïù∏ÏÇ¨Ïù¥Ìä∏Î•º Îß§Ï£º Ïù¥Î©îÏùºÎ°ú Î∞õÏïÑÎ≥¥ÏÑ∏Ïöî!</p>

            <form class="email-form" onsubmit="subscribeEmail(event)">
                <input type="email" class="email-input" placeholder="Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required id="emailInput">
                <button type="submit" class="submit-btn" id="submitBtn">Íµ¨ÎèÖÌïòÍ∏∞</button>
            </form>

            <div class="success-message" id="successMessage">
                ‚úÖ Íµ¨ÎèÖÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§! Îß§Ï£º Ïù∏ÏÇ¨Ïù¥Ìä∏Î•º Î∞õÏïÑÎ≥¥ÏÑ∏Ïöî.
            </div>
            <div class="error-message" id="errorMessage">
                ‚ùå Íµ¨ÎèÖ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.
            </div>

            <!-- Ï¶âÏãú ÌÖåÏä§Ìä∏ Î≤ÑÌäº -->
            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
                <p style="font-size: 14px; color: #666; margin-bottom: 10px;">
                    üìß Ï¶âÏãú ÌÖåÏä§Ìä∏: Íµ¨ÎèÖÌïòÏã† Ïù¥Î©îÏùºÎ°ú Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉòÌîåÏùÑ Î≥¥ÎÇ¥ÎìúÎ¶ΩÎãàÎã§
                </p>
                <button type="button" class="submit-btn" id="testSendBtn" onclick="sendTestInsight()"
                    style="background: #28a745;">
                    üí° Ïù∏ÏÇ¨Ïù¥Ìä∏ ÌÖåÏä§Ìä∏ Î∞úÏÜ°
                </button>
                <div class="success-message" id="testSuccessMessage" style="display: none;">
                    ‚úÖ ÌÖåÏä§Ìä∏ Ïù∏ÏÇ¨Ïù¥Ìä∏Í∞Ä Î∞úÏÜ°ÎêòÏóàÏäµÎãàÎã§!
                </div>
                <div class="error-message" id="testErrorMessage" style="display: none;">
                    ‚ùå ÌÖåÏä§Ìä∏ Î∞úÏÜ° Ïã§Ìå®. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.
                </div>
            </div>
        </div>
    </div>

    <script>
        // Íµ¨ÎèÖ Î™®Îã¨ Í¥ÄÎ†® Ìï®ÏàòÎì§
        function openSubscribeModal() {
            document.getElementById('subscribeModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeSubscribeModal() {
            document.getElementById('subscribeModal').style.display = 'none';
            document.body.style.overflow = 'auto';

            // Ìèº Ï¥àÍ∏∞Ìôî
            document.getElementById('emailInput').value = '';
            document.getElementById('successMessage').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('submitBtn').disabled = false;
            document.getElementById('submitBtn').textContent = 'Íµ¨ÎèÖÌïòÍ∏∞';
        }

        async function subscribeEmail(event) {
            event.preventDefault();

            const email = document.getElementById('emailInput').value;
            const submitBtn = document.getElementById('submitBtn');
            const successMsg = document.getElementById('successMessage');
            const errorMsg = document.getElementById('errorMessage');

            // Î≤ÑÌäº ÎπÑÌôúÏÑ±Ìôî
            submitBtn.disabled = true;
            submitBtn.textContent = 'Íµ¨ÎèÖ Ï§ë...';

            try {
                const response = await fetch('/api/subscribe', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email: email })
                });

                const result = await response.json();

                if (response.ok) {
                    successMsg.style.display = 'block';
                    errorMsg.style.display = 'none';
                    document.getElementById('emailInput').value = '';

                    // 3Ï¥à ÌõÑ Î™®Îã¨ Îã´Í∏∞
                    setTimeout(() => {
                        closeSubscribeModal();
                    }, 3000);
                } else {
                    throw new Error(result.detail || 'Íµ¨ÎèÖ Ïã§Ìå®');
                }
            } catch (error) {
                errorMsg.style.display = 'block';
                errorMsg.textContent = `‚ùå ${error.message}`;
                successMsg.style.display = 'none';
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Íµ¨ÎèÖÌïòÍ∏∞';
            }
        }

        // ÌÖåÏä§Ìä∏ Ïù∏ÏÇ¨Ïù¥Ìä∏ Î∞úÏÜ° Ìï®Ïàò
        async function sendTestInsight() {
            const email = document.getElementById('emailInput').value;
            const testBtn = document.getElementById('testSendBtn');
            const testSuccessMsg = document.getElementById('testSuccessMessage');
            const testErrorMsg = document.getElementById('testErrorMessage');

            if (!email) {
                alert('Ïù¥Î©îÏùºÏùÑ Î®ºÏ†Ä ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }

            // Î≤ÑÌäº ÎπÑÌôúÏÑ±Ìôî
            testBtn.disabled = true;
            testBtn.textContent = 'Î∞úÏÜ° Ï§ë...';
            testSuccessMsg.style.display = 'none';
            testErrorMsg.style.display = 'none';

            try {
                const response = await fetch('/api/send-insights', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email: email })
                });

                const result = await response.json();

                if (response.ok) {
                    testSuccessMsg.style.display = 'block';
                    testErrorMsg.style.display = 'none';
                } else {
                    throw new Error(result.detail || 'Î∞úÏÜ° Ïã§Ìå®');
                }
            } catch (error) {
                testErrorMsg.style.display = 'block';
                testErrorMsg.textContent = `‚ùå ${error.message}`;
                testSuccessMsg.style.display = 'none';
            } finally {
                // Î≤ÑÌäº Î≥µÏõê
                testBtn.disabled = false;
                testBtn.textContent = 'üí° Ïù∏ÏÇ¨Ïù¥Ìä∏ ÌÖåÏä§Ìä∏ Î∞úÏÜ°';
            }
        }

        // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
        window.onclick = function (event) {
            const modal = document.getElementById('subscribeModal');
            if (event.target === modal) {
                closeSubscribeModal();
            }
        }
    </script>
</body>

</html>