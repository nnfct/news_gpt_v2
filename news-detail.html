<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üì∫ News Detail - AI Îâ¥Ïä§ Î∂ÑÏÑù</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', Arial, sans-serif;
      background: #0f0f0f;
      color: #fff;
      line-height: 1.6;
    }

    /* Ïú†ÌäúÎ∏å Ïä§ÌÉÄÏùº Ìó§Îçî */
    .header {
      background: #212121;
      padding: 12px 16px;
      border-bottom: 1px solid #333;
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
      color: #fff;
    }

    .logo h1 {
      font-size: 20px;
      font-weight: 500;
    }

    .back-btn {
      background: #303030;
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .back-btn:hover {
      background: #404040;
    }

    /* Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà */
    .main-container {
      max-width: 1280px;
      margin: 0 auto;
      display: flex;
      gap: 24px;
      padding: 24px 16px;
    }

    /* Î©îÏù∏ ÏΩòÌÖêÏ∏† */
    .main-content {
      flex: 1;
      max-width: 854px;
    }

    /* ÎπÑÎîîÏò§ ÌîåÎ†àÏù¥Ïñ¥ ÏòÅÏó≠ */
    .video-container {
      background: #1a1a1a;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 20px;
      position: relative;
    }

    .video-player {
      width: 100%;
      height: 360px;
      background: linear-gradient(135deg, #1C2039, #00D9C0);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .video-player::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg,
          rgba(28, 32, 57, 0.9) 0%,
          rgba(0, 217, 192, 0.1) 100%);
    }

    .play-button {
      width: 60px;
      height: 60px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
      z-index: 2;
      margin-bottom: 15px;
    }

    .play-button:hover {
      background: rgba(255, 255, 255, 1);
      transform: scale(1.1);
    }

    .play-button::after {
      content: '‚ñ∂';
      font-size: 24px;
      color: #1C2039;
      margin-left: 3px;
    }

    .video-title-overlay {
      text-align: center;
      z-index: 2;
      max-width: 80%;
    }

    .video-title-overlay h2 {
      font-size: 21px;
      margin-bottom: 9px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .video-subtitle {
      font-size: 12px;
      opacity: 0.9;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
    }

    /* ÎπÑÎîîÏò§ Ï†ïÎ≥¥ */
    .video-info {
      padding: 20px;
      border-bottom: 1px solid #333;
    }

    .video-title {
      font-size: 20px;
      font-weight: 500;
      margin-bottom: 12px;
      line-height: 1.4;
    }

    .video-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .video-stats {
      display: flex;
      align-items: center;
      gap: 16px;
      color: #aaa;
      font-size: 14px;
    }

    .video-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .action-btn {
      background: #303030;
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
    }

    .action-btn:hover {
      background: #404040;
    }

    .action-btn.liked {
      background: #065fd4;
    }

    /* Ï±ÑÎÑê Ï†ïÎ≥¥ */
    .channel-info {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 0;
    }

    .channel-avatar {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #00D9C0, #1C2039);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .channel-details {
      flex: 1;
    }

    .channel-name {
      font-weight: 500;
      margin-bottom: 4px;
    }

    .channel-subscribers {
      color: #aaa;
      font-size: 12px;
    }

    .subscribe-channel-btn {
      background: #cc0000;
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 18px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .subscribe-channel-btn:hover {
      background: #aa0000;
    }

    .subscribe-channel-btn.subscribed {
      background: #606060;
    }

    /* ÏÑ§Î™Ö */
    .description {
      padding: 16px 0;
      border-bottom: 1px solid #333;
    }

    .description-content {
      background: #1a1a1a;
      padding: 16px;
      border-radius: 8px;
      line-height: 1.6;
    }

    .show-more {
      color: #3ea6ff;
      cursor: pointer;
      margin-top: 8px;
      font-size: 14px;
    }

    .show-more:hover {
      text-decoration: underline;
    }

    /* ÏÇ¨Ïù¥ÎìúÎ∞î */
    .sidebar {
      width: 402px;
      padding-left: 24px;
    }

    .sidebar-section {
      margin-bottom: 32px;
    }

    .sidebar-title {
      font-size: 16px;
      font-weight: 500;
      margin-bottom: 16px;
    }

    /* Í¥ÄÎ†® Îâ¥Ïä§ */
    .related-news {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .related-item {
      display: flex;
      gap: 12px;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: background 0.2s;
    }

    .related-item:hover {
      background: #1a1a1a;
    }

    .related-thumbnail {
      width: 168px;
      height: 94px;
      background: linear-gradient(135deg, #1C2039, #00D9C0);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      flex-shrink: 0;
    }

    .related-info {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .related-title {
      font-size: 14px;
      font-weight: 500;
      line-height: 1.4;
      margin-bottom: 4px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .related-meta {
      color: #aaa;
      font-size: 12px;
    }

    /* ÌÇ§ÏõåÎìú ÌÉúÍ∑∏ */
    .keyword-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }

    .keyword-tag {
      background: #303030;
      color: #fff;
      padding: 6px 12px;
      border-radius: 16px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .keyword-tag:hover {
      background: #404040;
    }

    /* AI Ïù∏ÏÇ¨Ïù¥Ìä∏ Ïπ¥Îìú */
    .insight-card {
      background: #1a1a1a;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border-left: 4px solid #00D9C0;
    }

    .insight-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .insight-title {
      font-size: 16px;
      font-weight: 500;
      color: #00D9C0;
    }

    .insight-content {
      line-height: 1.6;
      color: #ccc;
    }

    /* ÌÜµÍ≥Ñ Ï∞®Ìä∏ */
    .stats-chart {
      background: #1a1a1a;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .chart-title {
      font-size: 16px;
      font-weight: 500;
      margin-bottom: 16px;
    }

    .chart-bar {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
    }

    .chart-label {
      width: 80px;
      font-size: 12px;
      color: #aaa;
    }

    .chart-progress {
      flex: 1;
      height: 8px;
      background: #333;
      border-radius: 4px;
      margin: 0 12px;
      overflow: hidden;
    }

    .chart-fill {
      height: 100%;
      background: linear-gradient(90deg, #00D9C0, #1C2039);
      border-radius: 4px;
      transition: width 0.5s ease;
    }

    .chart-value {
      font-size: 12px;
      color: #fff;
      min-width: 40px;
      text-align: right;
    }

    /* Î∞òÏùëÌòï */
    @media (max-width: 1024px) {
      .main-container {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        padding-left: 0;
      }

      .video-player {
        height: 270px;
      }
    }

    @media (max-width: 768px) {
      .main-container {
        padding: 16px 12px;
      }

      .video-player {
        height: 180px;
      }

      .video-title-overlay h2 {
        font-size: 15px;
      }

      .video-subtitle {
        font-size: 10px;
      }

      .related-thumbnail {
        width: 120px;
        height: 68px;
      }
    }

    /* Î°úÎî© Ïï†ÎãàÎ©îÏù¥ÏÖò */
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
      color: #aaa;
    }

    .spinner {
      width: 24px;
      height: 24px;
      border: 2px solid #333;
      border-top: 2px solid #00D9C0;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 12px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>
</head>

<body>
  <!-- Ïú†ÌäúÎ∏å Ïä§ÌÉÄÏùº Ìó§Îçî -->
  <div class="header">
    <div class="logo-section">
      <button class="back-btn" onclick="goBack()">
        <span>‚Üê</span>
        <span>Îí§Î°úÍ∞ÄÍ∏∞</span>
      </button>
      <a href="/" class="logo">
        <span style="font-size: 24px;">üì∫</span>
        <h1>News TUBE GPT v2</h1>
      </a>
    </div>
  </div>

  <div class="main-container">
    <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† -->
    <div class="main-content">
      <!-- ÎπÑÎîîÏò§ ÌîåÎ†àÏù¥Ïñ¥ ÏòÅÏó≠ -->
      <div class="video-container">
        <div class="video-player" id="videoPlayer">
          <div class="play-button" onclick="playVideo()"></div>
          <div class="video-title-overlay">
            <h2 id="videoTitle">Îâ¥Ïä§ Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏</h2>
            <p class="video-subtitle" id="videoSubtitle">AIÍ∞Ä Î∂ÑÏÑùÌïú ÏµúÏã† Îâ¥Ïä§ Ìä∏Î†åÎìú</p>
          </div>
        </div>
      </div>

      <!-- ÎπÑÎîîÏò§ Ï†ïÎ≥¥ -->
      <div class="video-info">
        <h1 class="video-title" id="mainTitle">Îâ¥Ïä§ Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏</h1>

        <div class="video-meta">
          <div class="video-stats">
            <span id="viewCount">Ï°∞ÌöåÏàò 1,234Ìöå</span>
            <span>‚Ä¢</span>
            <span id="publishDate">2025ÎÖÑ 7Ïõî 21Ïùº</span>
          </div>

          <div class="video-actions">
            <button class="action-btn" onclick="toggleLike()">
              <span>üëç</span>
              <span id="likeCount">42</span>
            </button>
            <button class="action-btn" onclick="shareVideo()">
              <span>üì§</span>
              <span>Í≥µÏú†</span>
            </button>
            <button class="action-btn" onclick="saveVideo()">
              <span>üíæ</span>
              <span>Ï†ÄÏû•</span>
            </button>
          </div>
        </div>

        <!-- Ï±ÑÎÑê Ï†ïÎ≥¥ -->
        <div class="channel-info">
          <div class="channel-avatar">ü§ñ</div>
          <div class="channel-details">
            <div class="channel-name">AI News Analyzer</div>
            <div class="channel-subscribers">Íµ¨ÎèÖÏûê 12.5ÎßåÎ™Ö</div>
          </div>
          <button class="subscribe-channel-btn" onclick="toggleSubscribe()">Íµ¨ÎèÖ</button>
        </div>

        <!-- ÌÇ§ÏõåÎìú ÌÉúÍ∑∏ -->
        <div class="keyword-tags" id="keywordTags">
          <!-- ÌÇ§ÏõåÎìú ÌÉúÍ∑∏Îì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
        </div>

        <!-- ÏÑ§Î™Ö -->
        <div class="description">
          <div class="description-content" id="descriptionContent">
            <div class="loading">
              <div class="spinner"></div>
              <span>Îâ¥Ïä§ Î∂ÑÏÑù Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...</span>
            </div>
          </div>
          <div class="show-more" onclick="toggleDescription()">ÎçîÎ≥¥Í∏∞</div>
        </div>
      </div>
    </div>

    <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
    <div class="sidebar">
      <!-- AI Ïù∏ÏÇ¨Ïù¥Ìä∏ -->
      <div class="sidebar-section">
        <div class="insight-card">
          <div class="insight-header">
            <span>ü§ñ</span>
            <div class="insight-title">AI Ïù∏ÏÇ¨Ïù¥Ìä∏</div>
          </div>
          <div class="insight-content" id="aiInsight">
            <div class="loading">
              <div class="spinner"></div>
              <span>AI Î∂ÑÏÑù Ï§ë...</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ÌÜµÍ≥Ñ Ï∞®Ìä∏ -->
      <div class="sidebar-section">
        <div class="stats-chart">
          <div class="chart-title">üìä ÌÇ§ÏõåÎìú Ìä∏Î†åÎìú</div>
          <div id="trendChart">
            <div class="loading">
              <div class="spinner"></div>
              <span>Ï∞®Ìä∏ Î°úÎî© Ï§ë...</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Í¥ÄÎ†® Îâ¥Ïä§ -->
      <div class="sidebar-section">
        <div class="sidebar-title">Í¥ÄÎ†® Îâ¥Ïä§</div>
        <div class="related-news" id="relatedNews">
          <div class="loading">
            <div class="spinner"></div>
            <span>Í¥ÄÎ†® Îâ¥Ïä§ Î°úÎî© Ï§ë...</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentKeyword = '';
    let isSubscribed = false;
    let isLiked = false;
    let isDescriptionExpanded = false;

    // ÌéòÏù¥ÏßÄ Î°úÎìúÏãú Ïã§Ìñâ
    document.addEventListener('DOMContentLoaded', function () {
      // URLÏóêÏÑú ÌÇ§ÏõåÎìú ÌååÎùºÎØ∏ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
      const urlParams = new URLSearchParams(window.location.search);
      currentKeyword = urlParams.get('keyword') || 'AI';

      initializePage();
    });

    // ÌéòÏù¥ÏßÄ Ï¥àÍ∏∞Ìôî
    async function initializePage() {
      updatePageTitle();
      await loadNewsData();
      await loadRelatedNews();
      generateKeywordTags();
    }

    // ÌéòÏù¥ÏßÄ Ï†úÎ™© ÏóÖÎç∞Ïù¥Ìä∏
    function updatePageTitle() {
      const title = `${currentKeyword} Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏`;
      document.getElementById('videoTitle').textContent = title;
      document.getElementById('mainTitle').textContent = title;
      document.getElementById('videoSubtitle').textContent = `${currentKeyword} Í¥ÄÎ†® Îâ¥Ïä§ Ìä∏Î†åÎìú Î∂ÑÏÑù`;
      document.title = `üì∫ ${title} - News TUBE GPT v2`;
    }

    // Îâ¥Ïä§ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
    async function loadNewsData() {
      try {
        // ÌïÑÏàò ÌååÎùºÎØ∏ÌÑ∞ Ï∂îÍ∞Ä (start_date, end_date)
        const startDate = '2025-07-14';
        const endDate = '2025-07-21';
        const apiUrl = `/api/keyword-articles/${encodeURIComponent(currentKeyword)}?start_date=${startDate}&end_date=${endDate}`;

        console.log('API Ìò∏Ï∂ú:', apiUrl);
        const response = await fetch(apiUrl);

        if (response.ok) {
          const data = await response.json();
          console.log('API ÏùëÎãµ Îç∞Ïù¥ÌÑ∞:', data);
          console.log('Î∞õÏïÑÏò® Í∏∞ÏÇ¨ Ïàò:', data.articles ? data.articles.length : 0);
          displayNewsAnalysis(data);
        } else {
          console.error('API ÏùëÎãµ Ïò§Î•ò:', response.status, response.statusText);
          const errorText = await response.text();
          console.error('Ïò§Î•ò ÏÉÅÏÑ∏:', errorText);
          displaySampleAnalysis();
        }
      } catch (error) {
        console.error('Îâ¥Ïä§ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïò§Î•ò:', error);
        displaySampleAnalysis();
      }
    }

    // Îâ¥Ïä§ Î∂ÑÏÑù ÌëúÏãú
    function displayNewsAnalysis(data) {
      const articles = data.articles || [];

      // ÏÑ§Î™Ö ÏóÖÎç∞Ïù¥Ìä∏
      const description = generateDescription(articles);
      document.getElementById('descriptionContent').innerHTML = description;

      // AI Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
      const insight = generateAIInsight(articles);
      document.getElementById('aiInsight').innerHTML = insight;

      // Ìä∏Î†åÎìú Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
      generateTrendChart(articles);

      // Ï°∞ÌöåÏàò ÏóÖÎç∞Ïù¥Ìä∏
      document.getElementById('viewCount').textContent = `Ï°∞ÌöåÏàò ${articles.length * 47}Ìöå`;
    }

    // ÏÉòÌîå Î∂ÑÏÑù ÌëúÏãú
    function displaySampleAnalysis() {
      const sampleDescription = `
                <h3>${currentKeyword} Îâ¥Ïä§ Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏</h3>
                <p>Ï¥ù 15Í±¥Ïùò Í¥ÄÎ†® Í∏∞ÏÇ¨Î•º AIÍ∞Ä Î∂ÑÏÑùÌñàÏäµÎãàÎã§.</p>
                <br>
                <p><strong>Ï£ºÏöî ÎÇ¥Ïö©:</strong></p>
                <ul>
                    <li><strong>[1]</strong> ${currentKeyword} Í∏∞Ïà†Ïùò Í∏âÏÜçÌïú Î∞úÏ†ÑÍ≥º ÏãúÏû• Ï†ÑÎßù</li>
                    <li><strong>[2]</strong> ÏÇ∞ÏóÖ Ï†ÑÎ∞òÏóê ÎØ∏ÏπòÎäî ${currentKeyword}Ïùò ÏòÅÌñ• ÌôïÎåÄ</li>
                    <li><strong>[3]</strong> ${currentKeyword} Í¥ÄÎ†® Ï†ïÏ±Ö Î∞è Í∑úÏ†ú ÎÖºÏùò ÌôúÎ∞ú</li>
                    <li><strong>[4]</strong> ${currentKeyword} Î∂ÑÏïº Ìà¨Ïûê Î∞è M&A ÌôúÎèô Ï¶ùÍ∞Ä</li>
                    <li><strong>[5]</strong> ${currentKeyword} Í∏∞Ïà† ÌëúÏ§ÄÌôî Î∞è Íµ≠Ï†ú ÌòëÎ†• Í∞ïÌôî</li>
                    <li><strong>[6]</strong> ${currentKeyword} Ïù∏Ïû¨ ÏñëÏÑ± Î∞è ÍµêÏú° ÌîÑÎ°úÍ∑∏Îû® ÌôïÎåÄ</li>
                    <li><strong>[7]</strong> ${currentKeyword} Î≥¥Ïïà Î∞è Ïú§Î¶¨Ï†Å Ïù¥Ïäà ÎåÄÎëê</li>
                    <li><strong>[8]</strong> ${currentKeyword} Ïä§ÌÉÄÌä∏ÏóÖ ÏÉùÌÉúÍ≥Ñ ÌôúÏÑ±Ìôî</li>
                    <li><strong>[9]</strong> ${currentKeyword} Í¥ÄÎ†® ÌäπÌóà Ï∂úÏõê Í∏âÏ¶ù</li>
                    <li><strong>[10]</strong> ${currentKeyword} Íµ≠Ï†ú Í≤ΩÏüÅÎ†• Í∞ïÌôî Î∞©Ïïà</li>
                    <li><strong>[11]</strong> ${currentKeyword} Í∏∞Î∞ò Ïã†Ï†úÌíà Ï∂úÏãú Îü¨Ïãú</li>
                    <li><strong>[12]</strong> ${currentKeyword} Í¥ÄÎ†® Î≤ïÏ†úÎèÑ Ï†ïÎπÑ ÎÖºÏùò</li>
                    <li><strong>[13]</strong> ${currentKeyword} Í∏∞Ïà† ÎèÑÏûÖ Í∏∞ÏóÖ ÏÑ±Í≥º Î∂ÑÏÑù</li>
                    <li><strong>[14]</strong> ${currentKeyword} Î∂ÑÏïº Í∏ÄÎ°úÎ≤å Ìä∏Î†åÎìú Î≥ÄÌôî</li>
                    <li><strong>[15]</strong> ${currentKeyword} ÎØ∏Îûò Î∞úÏ†Ñ Î∞©Ìñ•Í≥º Ï†ÑÎßù</li>
                </ul>
                <br>
                <p><strong>Î∂ÑÏÑù Í∏∞Í∞Ñ:</strong> 2025ÎÖÑ 7Ïõî 14Ïùº ~ 7Ïõî 21Ïùº</p>
                <p><strong>Î∂ÑÏÑù Í∏∞ÏÇ¨ Ïàò:</strong> 15Í±¥</p>
                <p><strong>Ï£ºÏöî ÌÇ§ÏõåÎìú:</strong> ${currentKeyword}, ÌòÅÏã†, Í∏∞Ïà†, Î∞úÏ†Ñ, ÎØ∏Îûò</p>
            `;

      document.getElementById('descriptionContent').innerHTML = sampleDescription;

      const sampleInsight = `
                ${currentKeyword}Îäî ÌòÑÏû¨ Í∞ÄÏû• Ï£ºÎ™©Î∞õÎäî Í∏∞Ïà† Î∂ÑÏïº Ï§ë ÌïòÎÇòÎ°ú, 
                Îã§ÏñëÌïú ÏÇ∞ÏóÖÏóêÏÑú ÌòÅÏã†ÏùÑ Ïù¥ÎÅåÍ≥† ÏûàÏäµÎãàÎã§. 
                ÌäπÌûà ÏµúÍ∑º ÏùºÏ£ºÏùºÍ∞ÑÏùò Îâ¥Ïä§ Î∂ÑÏÑù Í≤∞Í≥º, 
                ${currentKeyword} Í¥ÄÎ†® Ìà¨ÏûêÏôÄ Í∞úÎ∞úÏù¥ Í∏âÏÜçÎèÑÎ°ú Ï¶ùÍ∞ÄÌïòÍ≥† ÏûàÏúºÎ©∞, 
                Ïù¥Îäî Ìñ•ÌõÑ ÏãúÏû•Ïóê ÌÅ∞ Î≥ÄÌôîÎ•º Í∞ÄÏ†∏Ïò¨ Í≤ÉÏúºÎ°ú ÏòàÏÉÅÎê©ÎãàÎã§.
            `;

      document.getElementById('aiInsight').innerHTML = sampleInsight;

      // ÏÉòÌîå Ìä∏Î†åÎìú Ï∞®Ìä∏
      generateSampleTrendChart();
    }

    // ÏÑ§Î™Ö ÏÉùÏÑ±
    function generateDescription(articles) {
      if (articles.length === 0) {
        return displaySampleAnalysis();
      }

      return `
                <h3>${currentKeyword} Îâ¥Ïä§ Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏</h3>
                <p>Ï¥ù ${articles.length}Í±¥Ïùò Í¥ÄÎ†® Í∏∞ÏÇ¨Î•º AIÍ∞Ä Î∂ÑÏÑùÌñàÏäµÎãàÎã§.</p>
                <br>
                <p><strong>Ï£ºÏöî ÎÇ¥Ïö©:</strong></p>
                <ul>
                    ${articles.slice(0, Math.min(articles.length, 15)).map((article, index) =>
        `<li><strong>[${index + 1}]</strong> ${article.title}</li>`
      ).join('')}
                </ul>
                <br>
                <p><strong>Î∂ÑÏÑù ÏùºÏãú:</strong> ${new Date().toLocaleString('ko-KR')}</p>
            `;
    }

    // AI Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±
    function generateAIInsight(articles) {
      const insights = [
        `${currentKeyword}Îäî ÌòÑÏû¨ Îß§Ïö∞ ÌôúÎ∞úÌïú ÎÖºÏùòÍ∞Ä Ïù¥Î£®Ïñ¥ÏßÄÍ≥† ÏûàÎäî Ï£ºÏ†úÏûÖÎãàÎã§.`,
        `ÏµúÍ∑º ${currentKeyword} Í¥ÄÎ†® Îâ¥Ïä§Í∞Ä Í∏âÏ¶ùÌïòÎ©∞ ÏóÖÍ≥ÑÏùò Ï£ºÎ™©ÏùÑ Î∞õÍ≥† ÏûàÏäµÎãàÎã§.`,
        `${currentKeyword} Î∂ÑÏïºÏùò Í∏∞Ïà† Î∞úÏ†ÑÏù¥ Îã§ÏñëÌïú ÏÇ∞ÏóÖÏóê ÏòÅÌñ•ÏùÑ ÎØ∏ÏπòÍ≥† ÏûàÏäµÎãàÎã§.`,
        `${currentKeyword}Ïóê ÎåÄÌïú Ìà¨ÏûêÏôÄ Ïó∞Íµ¨Í∞úÎ∞úÏù¥ ÌôúÎ∞úÌûà ÏßÑÌñâÎêòÍ≥† ÏûàÏäµÎãàÎã§.`
      ];

      return insights[Math.floor(Math.random() * insights.length)];
    }

    // Ìä∏Î†åÎìú Ï∞®Ìä∏ ÏÉùÏÑ±
    function generateTrendChart(articles) {
      const chartData = [
        { label: 'Ïù¥Î≤à Ï£º', value: articles.length || 247, percentage: 100 },
        { label: 'ÏßÄÎÇú Ï£º', value: Math.floor((articles.length || 247) * 0.8), percentage: 80 },
        { label: '2Ï£º Ï†Ñ', value: Math.floor((articles.length || 247) * 0.6), percentage: 60 },
        { label: '3Ï£º Ï†Ñ', value: Math.floor((articles.length || 247) * 0.4), percentage: 40 }
      ];

      const chartHTML = chartData.map(item => `
                <div class="chart-bar">
                    <div class="chart-label">${item.label}</div>
                    <div class="chart-progress">
                        <div class="chart-fill" style="width: ${item.percentage}%"></div>
                    </div>
                    <div class="chart-value">${item.value}</div>
                </div>
            `).join('');

      document.getElementById('trendChart').innerHTML = chartHTML;
    }

    // ÏÉòÌîå Ìä∏Î†åÎìú Ï∞®Ìä∏ ÏÉùÏÑ±
    function generateSampleTrendChart() {
      const chartData = [
        { label: 'Ïù¥Î≤à Ï£º', value: 247, percentage: 100 },
        { label: 'ÏßÄÎÇú Ï£º', value: 198, percentage: 80 },
        { label: '2Ï£º Ï†Ñ', value: 148, percentage: 60 },
        { label: '3Ï£º Ï†Ñ', value: 99, percentage: 40 }
      ];

      const chartHTML = chartData.map(item => `
                <div class="chart-bar">
                    <div class="chart-label">${item.label}</div>
                    <div class="chart-progress">
                        <div class="chart-fill" style="width: ${item.percentage}%"></div>
                    </div>
                    <div class="chart-value">${item.value}</div>
                </div>
            `).join('');

      document.getElementById('trendChart').innerHTML = chartHTML;
    }

    // Í¥ÄÎ†® Îâ¥Ïä§ Î°úÎìú
    async function loadRelatedNews() {
      try {
        // Îã§Î•∏ ÌÇ§ÏõåÎìúÎì§Ïùò Îâ¥Ïä§ Í∞ÄÏ†∏Ïò§Í∏∞
        const keywords = ['AI', 'Î∞òÎèÑÏ≤¥', 'Î∞îÏù¥Ïò§', 'Ï†ÑÍ∏∞Ï∞®', 'Î©îÌÉÄÎ≤ÑÏä§', 'Î∏îÎ°ùÏ≤¥Ïù∏'];
        const relatedKeywords = keywords.filter(k => k !== currentKeyword).slice(0, 5);

        const relatedHTML = relatedKeywords.map((keyword, index) => `
                    <div class="related-item" onclick="openRelatedNews('${keyword}')">
                        <div class="related-thumbnail">${getKeywordIcon(keyword)}</div>
                        <div class="related-info">
                            <div class="related-title">${keyword} Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏</div>
                            <div class="related-meta">
                                <div>AI News Analyzer</div>
                                <div>Ï°∞ÌöåÏàò ${Math.floor(Math.random() * 1000) + 500}Ìöå ‚Ä¢ ${Math.floor(Math.random() * 7) + 1}Ïùº Ï†Ñ</div>
                            </div>
                        </div>
                    </div>
                `).join('');

        document.getElementById('relatedNews').innerHTML = relatedHTML;
      } catch (error) {
        console.error('Í¥ÄÎ†® Îâ¥Ïä§ Î°úÎìú Ïò§Î•ò:', error);
        document.getElementById('relatedNews').innerHTML = '<p>Í¥ÄÎ†® Îâ¥Ïä§Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.</p>';
      }
    }

    // ÌÇ§ÏõåÎìúÎ≥Ñ ÏïÑÏù¥ÏΩò Î∞òÌôò
    function getKeywordIcon(keyword) {
      const icons = {
        'AI': 'ü§ñ', 'Ïù∏Í≥µÏßÄÎä•': 'ü§ñ', 'GPT': 'ü§ñ',
        'Î∞òÎèÑÏ≤¥': 'üîß', 'Î©îÎ™®Î¶¨': 'üíæ', 'CPU': '‚ö°',
        'Î∞îÏù¥Ïò§': 'üß¨', 'ÏùòÎ£å': 'üè•', 'Ìó¨Ïä§ÏºÄÏñ¥': 'üíä',
        'ÏûêÎèôÏ∞®': 'üöó', 'Ï†ÑÍ∏∞Ï∞®': 'üîã', 'Î∞∞ÌÑ∞Î¶¨': 'üîã',
        'Î∏îÎ°ùÏ≤¥Ïù∏': '‚õìÔ∏è', 'ÏïîÌò∏ÌôîÌèê': 'üí∞', 'ÎπÑÌä∏ÏΩîÏù∏': '‚Çø',
        'Í≤åÏûÑ': 'üéÆ', 'Î©îÌÉÄÎ≤ÑÏä§': 'ü•Ω', 'VR': 'ü•Ω',
        'ÌÅ¥ÎùºÏö∞Îìú': '‚òÅÔ∏è', 'ÏÑúÎ≤Ñ': 'üñ•Ô∏è', 'Îç∞Ïù¥ÌÑ∞': 'üìä'
      };

      for (const [key, icon] of Object.entries(icons)) {
        if (keyword.includes(key)) return icon;
      }

      return 'üì∞';
    }

    // ÌÇ§ÏõåÎìú ÌÉúÍ∑∏ ÏÉùÏÑ±
    function generateKeywordTags() {
      const relatedKeywords = [
        currentKeyword,
        'Í∏∞Ïà†Ìä∏Î†åÎìú',
        'ÌòÅÏã†',
        'ÎØ∏ÎûòÍ∏∞Ïà†',
        'ÏÇ∞ÏóÖÎ∂ÑÏÑù'
      ];

      const tagsHTML = relatedKeywords.map(tag =>
        `<div class="keyword-tag" onclick="searchKeyword('${tag}')">#${tag}</div>`
      ).join('');

      document.getElementById('keywordTags').innerHTML = tagsHTML;
    }

    // ÎπÑÎîîÏò§ Ïû¨ÏÉù (Ïã§Ï†úÎ°úÎäî analysis.htmlÎ°ú Ïù¥Îèô)
    function playVideo() {
      window.location.href = `/analysis.html?keyword=${encodeURIComponent(currentKeyword)}`;
    }

    // Ï¢ãÏïÑÏöî ÌÜ†Í∏Ä
    function toggleLike() {
      isLiked = !isLiked;
      const likeBtn = document.querySelector('.action-btn');
      const likeCount = document.getElementById('likeCount');

      if (isLiked) {
        likeBtn.classList.add('liked');
        likeCount.textContent = parseInt(likeCount.textContent) + 1;
      } else {
        likeBtn.classList.remove('liked');
        likeCount.textContent = parseInt(likeCount.textContent) - 1;
      }
    }

    // Íµ¨ÎèÖ ÌÜ†Í∏Ä
    function toggleSubscribe() {
      isSubscribed = !isSubscribed;
      const subscribeBtn = document.querySelector('.subscribe-channel-btn');

      if (isSubscribed) {
        subscribeBtn.textContent = 'Íµ¨ÎèÖÏ§ë';
        subscribeBtn.classList.add('subscribed');
      } else {
        subscribeBtn.textContent = 'Íµ¨ÎèÖ';
        subscribeBtn.classList.remove('subscribed');
      }
    }

    // ÏÑ§Î™Ö ÌÜ†Í∏Ä
    function toggleDescription() {
      isDescriptionExpanded = !isDescriptionExpanded;
      const showMoreBtn = document.querySelector('.show-more');

      if (isDescriptionExpanded) {
        showMoreBtn.textContent = 'Í∞ÑÎûµÌûà';
      } else {
        showMoreBtn.textContent = 'ÎçîÎ≥¥Í∏∞';
      }
    }

    // ÎπÑÎîîÏò§ Í≥µÏú†
    function shareVideo() {
      if (navigator.share) {
        navigator.share({
          title: `${currentKeyword} Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏`,
          text: `${currentKeyword} Í¥ÄÎ†® Îâ¥Ïä§ Ìä∏Î†åÎìú Î∂ÑÏÑù`,
          url: window.location.href
        });
      } else {
        // ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê URL Î≥µÏÇ¨
        navigator.clipboard.writeText(window.location.href);
        alert('ÎßÅÌÅ¨Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!');
      }
    }

    // ÎπÑÎîîÏò§ Ï†ÄÏû•
    function saveVideo() {
      alert('Ï†ÄÏû• Í∏∞Îä•ÏùÄ Ï§ÄÎπÑ Ï§ëÏûÖÎãàÎã§!');
    }

    // Í¥ÄÎ†® Îâ¥Ïä§ Ïó¥Í∏∞
    function openRelatedNews(keyword) {
      window.location.href = `/news-detail.html?keyword=${encodeURIComponent(keyword)}`;
    }

    // ÌÇ§ÏõåÎìú Í≤ÄÏÉâ
    function searchKeyword(keyword) {
      window.location.href = `/analysis.html?keyword=${encodeURIComponent(keyword)}`;
    }

    // Îí§Î°úÍ∞ÄÍ∏∞
    function goBack() {
      if (document.referrer) {
        window.history.back();
      } else {
        window.location.href = '/';
      }
    }
  </script>
</body>

</html>