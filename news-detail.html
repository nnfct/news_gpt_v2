<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ“º News Detail - AI ë‰´ìŠ¤ ë¶„ì„</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', Arial, sans-serif;
      background: #0f0f0f;
      color: #fff;
      line-height: 1.6;
    }

    /* ìœ íŠœë¸Œ ìŠ¤íƒ€ì¼ í—¤ë” */
    .header {
      background: #212121;
      padding: 12px 16px;
      border-bottom: 1px solid #333;
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
      color: #fff;
    }

    .logo h1 {
      font-size: 20px;
      font-weight: 500;
    }

    .back-btn {
      background: #303030;
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .back-btn:hover {
      background: #404040;
    }

    /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
    .main-container {
      max-width: 1280px;
      margin: 0 auto;
      display: flex;
      gap: 24px;
      padding: 24px 16px;
    }

    /* ë©”ì¸ ì½˜í…ì¸  */
    .main-content {
      flex: 1;
      max-width: 854px;
    }

    /* ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ ì˜ì—­ */
    .video-container {
      background: #1a1a1a;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 20px;
      position: relative;
    }

    .video-player {
      width: 100%;
      height: 360px;
      background: linear-gradient(135deg, #1C2039, #00D9C0);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .video-player::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg,
          rgba(28, 32, 57, 0.9) 0%,
          rgba(0, 217, 192, 0.1) 100%);
    }

    .play-button {
      width: 60px;
      height: 60px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
      z-index: 2;
      margin-bottom: 15px;
    }

    .play-button:hover {
      background: rgba(255, 255, 255, 1);
      transform: scale(1.1);
    }

    .play-button::after {
      content: 'â–¶';
      font-size: 24px;
      color: #1C2039;
      margin-left: 3px;
    }

    .video-title-overlay {
      text-align: center;
      z-index: 2;
      max-width: 80%;
    }

    .video-title-overlay h2 {
      font-size: 21px;
      margin-bottom: 9px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .video-subtitle {
      font-size: 12px;
      opacity: 0.9;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
    }

    /* ë¹„ë””ì˜¤ ì •ë³´ */
    .video-info {
      padding: 20px;
      border-bottom: 1px solid #333;
    }

    .video-title {
      font-size: 20px;
      font-weight: 500;
      margin-bottom: 12px;
      line-height: 1.4;
    }

    .video-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .video-stats {
      display: flex;
      align-items: center;
      gap: 16px;
      color: #aaa;
      font-size: 14px;
    }

    .video-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .action-btn {
      background: #303030;
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
    }

    .action-btn:hover {
      background: #404040;
    }

    .action-btn.liked {
      background: #065fd4;
    }

    /* ì±„ë„ ì •ë³´ */
    .channel-info {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 0;
    }

    .channel-avatar {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #00D9C0, #1C2039);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .channel-details {
      flex: 1;
    }

    .channel-name {
      font-weight: 500;
      margin-bottom: 4px;
    }

    .channel-subscribers {
      color: #aaa;
      font-size: 12px;
    }

    .subscribe-channel-btn {
      background: #cc0000;
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 18px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .subscribe-channel-btn:hover {
      background: #aa0000;
    }

    .subscribe-channel-btn.subscribed {
      background: #606060;
    }

    /* ì„¤ëª… */
    .description {
      padding: 16px 0;
      border-bottom: 1px solid #333;
    }

    .description-content {
      background: #1a1a1a;
      padding: 16px;
      border-radius: 8px;
      line-height: 1.6;
    }

    .show-more {
      color: #3ea6ff;
      cursor: pointer;
      margin-top: 8px;
      font-size: 14px;
    }

    .show-more:hover {
      text-decoration: underline;
    }

    /* ì‚¬ì´ë“œë°” */
    .sidebar {
      width: 402px;
      padding-left: 24px;
    }

    .sidebar-section {
      margin-bottom: 32px;
    }

    .sidebar-title {
      font-size: 16px;
      font-weight: 500;
      margin-bottom: 16px;
    }

    /* ê´€ë ¨ ë‰´ìŠ¤ */
    .related-news {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .related-item {
      display: flex;
      gap: 12px;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: background 0.2s;
    }

    .related-item:hover {
      background: #1a1a1a;
    }

    .related-thumbnail {
      width: 168px;
      height: 94px;
      background: linear-gradient(135deg, #1C2039, #00D9C0);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      flex-shrink: 0;
    }

    .related-info {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .related-title {
      font-size: 14px;
      font-weight: 500;
      line-height: 1.4;
      margin-bottom: 4px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .related-meta {
      color: #aaa;
      font-size: 12px;
    }

    /* í‚¤ì›Œë“œ íƒœê·¸ */
    .keyword-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }

    .keyword-tag {
      background: #303030;
      color: #fff;
      padding: 6px 12px;
      border-radius: 16px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .keyword-tag:hover {
      background: #404040;
    }

    /* AI ì¸ì‚¬ì´íŠ¸ ì¹´ë“œ */
    .insight-card {
      background: #1a1a1a;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border-left: 4px solid #00D9C0;
    }

    .insight-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .insight-title {
      font-size: 16px;
      font-weight: 500;
      color: #00D9C0;
    }

    .insight-content {
      line-height: 1.6;
      color: #ccc;
    }

    /* í†µê³„ ì°¨íŠ¸ */
    .stats-chart {
      background: #1a1a1a;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .chart-title {
      font-size: 16px;
      font-weight: 500;
      margin-bottom: 16px;
    }

    .chart-bar {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
    }

    .chart-label {
      width: 80px;
      font-size: 12px;
      color: #aaa;
    }

    .chart-progress {
      flex: 1;
      height: 8px;
      background: #333;
      border-radius: 4px;
      margin: 0 12px;
      overflow: hidden;
    }

    .chart-fill {
      height: 100%;
      background: linear-gradient(90deg, #00D9C0, #1C2039);
      border-radius: 4px;
      transition: width 0.5s ease;
    }

    .chart-value {
      font-size: 12px;
      color: #fff;
      min-width: 40px;
      text-align: right;
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 1024px) {
      .main-container {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        padding-left: 0;
      }

      .video-player {
        height: 270px;
      }
    }

    @media (max-width: 768px) {
      .main-container {
        padding: 16px 12px;
      }

      .video-player {
        height: 180px;
      }

      .video-title-overlay h2 {
        font-size: 15px;
      }

      .video-subtitle {
        font-size: 10px;
      }

      .related-thumbnail {
        width: 120px;
        height: 68px;
      }
    }

    /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
      color: #aaa;
    }

    .spinner {
      width: 24px;
      height: 24px;
      border: 2px solid #333;
      border-top: 2px solid #00D9C0;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 12px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>
</head>

<body>
  <!-- ìœ íŠœë¸Œ ìŠ¤íƒ€ì¼ í—¤ë” -->
  <div class="header">
    <div class="logo-section">
      <button class="back-btn" onclick="goBack()">
        <span>â†</span>
        <span>ë’¤ë¡œê°€ê¸°</span>
      </button>
      <a href="/" class="logo">
        <span style="font-size: 24px;">ğŸ“º</span>
        <h1>News TUBE GPT v2</h1>
      </a>
    </div>
  </div>

  <div class="main-container">
    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <div class="main-content">
      <!-- ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ ì˜ì—­ -->
      <div class="video-container">
        <div class="video-player" id="videoPlayer">
          <div class="play-button" onclick="playVideo()"></div>
          <div class="video-title-overlay">
            <h2 id="videoTitle">ë‰´ìŠ¤ ë¶„ì„ ë¦¬í¬íŠ¸</h2>
            <p class="video-subtitle" id="videoSubtitle">AIê°€ ë¶„ì„í•œ ìµœì‹  ë‰´ìŠ¤ íŠ¸ë Œë“œ</p>
          </div>
        </div>
      </div>

      <!-- ë¹„ë””ì˜¤ ì •ë³´ -->
      <div class="video-info">
        <h1 class="video-title" id="mainTitle">ë‰´ìŠ¤ ë¶„ì„ ë¦¬í¬íŠ¸</h1>

        <div class="video-meta">
          <div class="video-stats">
            <span id="viewCount">ì¡°íšŒìˆ˜ 1,234íšŒ</span>
            <span>â€¢</span>
            <span id="publishDate">2025ë…„ 7ì›” 21ì¼</span>
          </div>

          <div class="video-actions">
            <button class="action-btn" onclick="toggleLike()">
              <span>ğŸ‘</span>
              <span id="likeCount">42</span>
            </button>
            <button class="action-btn" onclick="shareVideo()">
              <span>ğŸ“¤</span>
              <span>ê³µìœ </span>
            </button>
            <button class="action-btn" onclick="saveVideo()">
              <span>ğŸ’¾</span>
              <span>ì €ì¥</span>
            </button>
          </div>
        </div>

        <!-- ì±„ë„ ì •ë³´ -->
        <div class="channel-info">
          <div class="channel-avatar">ğŸ¤–</div>
          <div class="channel-details">
            <div class="channel-name">AI News Analyzer</div>
            <div class="channel-subscribers">êµ¬ë…ì 12.5ë§Œëª…</div>
          </div>
          <button class="subscribe-channel-btn" onclick="toggleSubscribe()">êµ¬ë…</button>
        </div>

        <!-- í‚¤ì›Œë“œ íƒœê·¸ -->
        <div class="keyword-tags" id="keywordTags">
          <!-- í‚¤ì›Œë“œ íƒœê·¸ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>

        <!-- ì„¤ëª… -->
        <div class="description">
          <div class="description-content" id="descriptionContent">
            <div class="loading">
              <div class="spinner"></div>
              <span>ë‰´ìŠ¤ ë¶„ì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
            </div>
          </div>
          <div class="show-more" onclick="toggleDescription()">ë”ë³´ê¸°</div>
        </div>
      </div>
    </div>

    <!-- ì‚¬ì´ë“œë°” -->
    <div class="sidebar">
      <!-- AI ì¸ì‚¬ì´íŠ¸ -->
      <div class="sidebar-section">
        <div class="insight-card">
          <div class="insight-header">
            <span>ğŸ¤–</span>
            <div class="insight-title">AI ì¸ì‚¬ì´íŠ¸</div>
          </div>
          <div class="insight-content" id="aiInsight">
            <div class="loading">
              <div class="spinner"></div>
              <span>AI ë¶„ì„ ì¤‘...</span>
            </div>
          </div>
        </div>
      </div>

      <!-- í†µê³„ ì°¨íŠ¸ -->
      <div class="sidebar-section">
        <div class="stats-chart">
          <div class="chart-title">ğŸ“Š í‚¤ì›Œë“œ íŠ¸ë Œë“œ</div>
          <div id="trendChart">
            <div class="loading">
              <div class="spinner"></div>
              <span>ì°¨íŠ¸ ë¡œë”© ì¤‘...</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ê´€ë ¨ ë‰´ìŠ¤ -->
      <div class="sidebar-section">
        <div class="sidebar-title">ê´€ë ¨ ë‰´ìŠ¤</div>
        <div class="related-news" id="relatedNews">
          <div class="loading">
            <div class="spinner"></div>
            <span>ê´€ë ¨ ë‰´ìŠ¤ ë¡œë”© ì¤‘...</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentKeyword = '';
    let isSubscribed = false;
    let isLiked = false;
    let isDescriptionExpanded = false;

    // í˜ì´ì§€ ë¡œë“œì‹œ ì‹¤í–‰
    document.addEventListener('DOMContentLoaded', function () {
      // URLì—ì„œ í‚¤ì›Œë“œ íŒŒë¼ë¯¸í„° ê°€ì ¸ì˜¤ê¸°
      const urlParams = new URLSearchParams(window.location.search);
      currentKeyword = urlParams.get('keyword') || 'AI';

      initializePage();
    });

    // í˜ì´ì§€ ì´ˆê¸°í™”
    async function initializePage() {
      updatePageTitle();
      await loadNewsData();
      await loadRelatedNews();
      generateKeywordTags();
    }

    // í˜ì´ì§€ ì œëª© ì—…ë°ì´íŠ¸
    function updatePageTitle() {
      const title = `${currentKeyword} ë¶„ì„ ë¦¬í¬íŠ¸`;
      document.getElementById('videoTitle').textContent = title;
      document.getElementById('mainTitle').textContent = title;
      document.getElementById('videoSubtitle').textContent = `${currentKeyword} ê´€ë ¨ ë‰´ìŠ¤ íŠ¸ë Œë“œ ë¶„ì„`;
      document.title = `ğŸ“º ${title} - News TUBE GPT v2`;
    }

    // ë‰´ìŠ¤ ë°ì´í„° ë¡œë“œ
    async function loadNewsData() {
      try {
        // í•„ìˆ˜ íŒŒë¼ë¯¸í„° ì¶”ê°€ (start_date, end_date)
        const startDate = '2025-07-14';
        const endDate = '2025-07-21';
        const apiUrl = `/api/keyword-articles/${encodeURIComponent(currentKeyword)}?start_date=${startDate}&end_date=${endDate}`;

        console.log('API í˜¸ì¶œ:', apiUrl);
        const response = await fetch(apiUrl);

        if (response.ok) {
          const data = await response.json();
          console.log('API ì‘ë‹µ ë°ì´í„°:', data);
          console.log('ë°›ì•„ì˜¨ ê¸°ì‚¬ ìˆ˜:', data.articles ? data.articles.length : 0);
          displayNewsAnalysis(data);
        } else {
          console.error('API ì‘ë‹µ ì˜¤ë¥˜:', response.status, response.statusText);
          const errorText = await response.text();
          console.error('ì˜¤ë¥˜ ìƒì„¸:', errorText);
          displaySampleAnalysis();
        }
      } catch (error) {
        console.error('ë‰´ìŠ¤ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
        displaySampleAnalysis();
      }
    }

    // ë‰´ìŠ¤ ë¶„ì„ í‘œì‹œ
    function displayNewsAnalysis(data) {
      const articles = data.articles || [];

      // ì„¤ëª… ì—…ë°ì´íŠ¸
      const description = generateDescription(articles);
      document.getElementById('descriptionContent').innerHTML = description;

      // AI ì¸ì‚¬ì´íŠ¸ ì—…ë°ì´íŠ¸
      const insight = generateAIInsight(articles);
      document.getElementById('aiInsight').innerHTML = insight;

      // íŠ¸ë Œë“œ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
      generateTrendChart(articles);

      // ì¡°íšŒìˆ˜ ì—…ë°ì´íŠ¸
      document.getElementById('viewCount').textContent = `ì¡°íšŒìˆ˜ ${articles.length * 47}íšŒ`;
    }

    // ìƒ˜í”Œ ë¶„ì„ í‘œì‹œ
    function displaySampleAnalysis() {
      const sampleDescription = `
                <h3>${currentKeyword} ë‰´ìŠ¤ ë¶„ì„ ë¦¬í¬íŠ¸</h3>
                <p>ì´ 15ê±´ì˜ ê´€ë ¨ ê¸°ì‚¬ë¥¼ AIê°€ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.</p>
                <br>
                <p><strong>ì£¼ìš” ë‚´ìš©:</strong></p>
                <ul>
                    <li><strong>[1]</strong> ${currentKeyword} ê¸°ìˆ ì˜ ê¸‰ì†í•œ ë°œì „ê³¼ ì‹œì¥ ì „ë§</li>
                    <li><strong>[2]</strong> ì‚°ì—… ì „ë°˜ì— ë¯¸ì¹˜ëŠ” ${currentKeyword}ì˜ ì˜í–¥ í™•ëŒ€</li>
                    <li><strong>[3]</strong> ${currentKeyword} ê´€ë ¨ ì •ì±… ë° ê·œì œ ë…¼ì˜ í™œë°œ</li>
                    <li><strong>[4]</strong> ${currentKeyword} ë¶„ì•¼ íˆ¬ì ë° M&A í™œë™ ì¦ê°€</li>
                    <li><strong>[5]</strong> ${currentKeyword} ê¸°ìˆ  í‘œì¤€í™” ë° êµ­ì œ í˜‘ë ¥ ê°•í™”</li>
                    <li><strong>[6]</strong> ${currentKeyword} ì¸ì¬ ì–‘ì„± ë° êµìœ¡ í”„ë¡œê·¸ë¨ í™•ëŒ€</li>
                    <li><strong>[7]</strong> ${currentKeyword} ë³´ì•ˆ ë° ìœ¤ë¦¬ì  ì´ìŠˆ ëŒ€ë‘</li>
                    <li><strong>[8]</strong> ${currentKeyword} ìŠ¤íƒ€íŠ¸ì—… ìƒíƒœê³„ í™œì„±í™”</li>
                    <li><strong>[9]</strong> ${currentKeyword} ê´€ë ¨ íŠ¹í—ˆ ì¶œì› ê¸‰ì¦</li>
                    <li><strong>[10]</strong> ${currentKeyword} êµ­ì œ ê²½ìŸë ¥ ê°•í™” ë°©ì•ˆ</li>
                    <li><strong>[11]</strong> ${currentKeyword} ê¸°ë°˜ ì‹ ì œí’ˆ ì¶œì‹œ ëŸ¬ì‹œ</li>
                    <li><strong>[12]</strong> ${currentKeyword} ê´€ë ¨ ë²•ì œë„ ì •ë¹„ ë…¼ì˜</li>
                    <li><strong>[13]</strong> ${currentKeyword} ê¸°ìˆ  ë„ì… ê¸°ì—… ì„±ê³¼ ë¶„ì„</li>
                    <li><strong>[14]</strong> ${currentKeyword} ë¶„ì•¼ ê¸€ë¡œë²Œ íŠ¸ë Œë“œ ë³€í™”</li>
                    <li><strong>[15]</strong> ${currentKeyword} ë¯¸ë˜ ë°œì „ ë°©í–¥ê³¼ ì „ë§</li>
                </ul>
                <br>
                <p><strong>ë¶„ì„ ê¸°ê°„:</strong> 2025ë…„ 7ì›” 14ì¼ ~ 7ì›” 21ì¼</p>
                <p><strong>ë¶„ì„ ê¸°ì‚¬ ìˆ˜:</strong> 15ê±´</p>
                <p><strong>ì£¼ìš” í‚¤ì›Œë“œ:</strong> ${currentKeyword}, í˜ì‹ , ê¸°ìˆ , ë°œì „, ë¯¸ë˜</p>
            `;

      document.getElementById('descriptionContent').innerHTML = sampleDescription;

      const sampleInsight = `
                ${currentKeyword}ëŠ” í˜„ì¬ ê°€ì¥ ì£¼ëª©ë°›ëŠ” ê¸°ìˆ  ë¶„ì•¼ ì¤‘ í•˜ë‚˜ë¡œ, 
                ë‹¤ì–‘í•œ ì‚°ì—…ì—ì„œ í˜ì‹ ì„ ì´ëŒê³  ìˆìŠµë‹ˆë‹¤. 
                íŠ¹íˆ ìµœê·¼ ì¼ì£¼ì¼ê°„ì˜ ë‰´ìŠ¤ ë¶„ì„ ê²°ê³¼, 
                ${currentKeyword} ê´€ë ¨ íˆ¬ìì™€ ê°œë°œì´ ê¸‰ì†ë„ë¡œ ì¦ê°€í•˜ê³  ìˆìœ¼ë©°, 
                ì´ëŠ” í–¥í›„ ì‹œì¥ì— í° ë³€í™”ë¥¼ ê°€ì ¸ì˜¬ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.
            `;

      document.getElementById('aiInsight').innerHTML = sampleInsight;

      // ìƒ˜í”Œ íŠ¸ë Œë“œ ì°¨íŠ¸
      generateSampleTrendChart();
    }

    // ì„¤ëª… ìƒì„±
    function generateDescription(articles) {
      if (articles.length === 0) {
        return displaySampleAnalysis();
      }

      return `
                <h3>${currentKeyword} ë‰´ìŠ¤ ë¶„ì„ ë¦¬í¬íŠ¸</h3>
                <p>ì´ ${articles.length}ê±´ì˜ ê´€ë ¨ ê¸°ì‚¬ë¥¼ AIê°€ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.</p>
                <br>
                <p><strong>ì£¼ìš” ë‚´ìš©:</strong></p>
                <ul>
                    ${articles.slice(0, Math.min(articles.length, 15)).map((article, index) =>
        `<li><strong>[${index + 1}]</strong> ${article.title}</li>`
      ).join('')}
                </ul>
                <br>
                <p><strong>ë¶„ì„ ì¼ì‹œ:</strong> ${new Date().toLocaleString('ko-KR')}</p>
            `;
    }

    // AI ì¸ì‚¬ì´íŠ¸ ìƒì„±
    function generateAIInsight(articles) {
      const insights = [
        `${currentKeyword}ëŠ” í˜„ì¬ ë§¤ìš° í™œë°œí•œ ë…¼ì˜ê°€ ì´ë£¨ì–´ì§€ê³  ìˆëŠ” ì£¼ì œì…ë‹ˆë‹¤.`,
        `ìµœê·¼ ${currentKeyword} ê´€ë ¨ ë‰´ìŠ¤ê°€ ê¸‰ì¦í•˜ë©° ì—…ê³„ì˜ ì£¼ëª©ì„ ë°›ê³  ìˆìŠµë‹ˆë‹¤.`,
        `${currentKeyword} ë¶„ì•¼ì˜ ê¸°ìˆ  ë°œì „ì´ ë‹¤ì–‘í•œ ì‚°ì—…ì— ì˜í–¥ì„ ë¯¸ì¹˜ê³  ìˆìŠµë‹ˆë‹¤.`,
        `${currentKeyword}ì— ëŒ€í•œ íˆ¬ìì™€ ì—°êµ¬ê°œë°œì´ í™œë°œíˆ ì§„í–‰ë˜ê³  ìˆìŠµë‹ˆë‹¤.`
      ];

      return insights[Math.floor(Math.random() * insights.length)];
    }

    // íŠ¸ë Œë“œ ì°¨íŠ¸ ìƒì„±
    function generateTrendChart(articles) {
      const chartData = [
        { label: 'ì´ë²ˆ ì£¼', value: articles.length || 247, percentage: 100 },
        { label: 'ì§€ë‚œ ì£¼', value: Math.floor((articles.length || 247) * 0.8), percentage: 80 },
        { label: '2ì£¼ ì „', value: Math.floor((articles.length || 247) * 0.6), percentage: 60 },
        { label: '3ì£¼ ì „', value: Math.floor((articles.length || 247) * 0.4), percentage: 40 }
      ];

      const chartHTML = chartData.map(item => `
                <div class="chart-bar">
                    <div class="chart-label">${item.label}</div>
                    <div class="chart-progress">
                        <div class="chart-fill" style="width: ${item.percentage}%"></div>
                    </div>
                    <div class="chart-value">${item.value}</div>
                </div>
            `).join('');

      document.getElementById('trendChart').innerHTML = chartHTML;
    }

    // ìƒ˜í”Œ íŠ¸ë Œë“œ ì°¨íŠ¸ ìƒì„±
    function generateSampleTrendChart() {
      const chartData = [
        { label: 'ì´ë²ˆ ì£¼', value: 247, percentage: 100 },
        { label: 'ì§€ë‚œ ì£¼', value: 198, percentage: 80 },
        { label: '2ì£¼ ì „', value: 148, percentage: 60 },
        { label: '3ì£¼ ì „', value: 99, percentage: 40 }
      ];

      const chartHTML = chartData.map(item => `
                <div class="chart-bar">
                    <div class="chart-label">${item.label}</div>
                    <div class="chart-progress">
                        <div class="chart-fill" style="width: ${item.percentage}%"></div>
                    </div>
                    <div class="chart-value">${item.value}</div>
                </div>
            `).join('');

      document.getElementById('trendChart').innerHTML = chartHTML;
    }

    // ê´€ë ¨ ë‰´ìŠ¤ ë¡œë“œ
    async function loadRelatedNews() {
      try {
        // ë‹¤ë¥¸ í‚¤ì›Œë“œë“¤ì˜ ë‰´ìŠ¤ ê°€ì ¸ì˜¤ê¸°
        const keywords = ['AI', 'ë°˜ë„ì²´', 'ë°”ì´ì˜¤', 'ì „ê¸°ì°¨', 'ë©”íƒ€ë²„ìŠ¤', 'ë¸”ë¡ì²´ì¸'];
        const relatedKeywords = keywords.filter(k => k !== currentKeyword).slice(0, 5);

        const relatedHTML = relatedKeywords.map((keyword, index) => `
                    <div class="related-item" onclick="openRelatedNews('${keyword}')">
                        <div class="related-thumbnail">${getKeywordIcon(keyword)}</div>
                        <div class="related-info">
                            <div class="related-title">${keyword} ë¶„ì„ ë¦¬í¬íŠ¸</div>
                            <div class="related-meta">
                                <div>AI News Analyzer</div>
                                <div>ì¡°íšŒìˆ˜ ${Math.floor(Math.random() * 1000) + 500}íšŒ â€¢ ${Math.floor(Math.random() * 7) + 1}ì¼ ì „</div>
                            </div>
                        </div>
                    </div>
                `).join('');

        document.getElementById('relatedNews').innerHTML = relatedHTML;
      } catch (error) {
        console.error('ê´€ë ¨ ë‰´ìŠ¤ ë¡œë“œ ì˜¤ë¥˜:', error);
        document.getElementById('relatedNews').innerHTML = '<p>ê´€ë ¨ ë‰´ìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
      }
    }

    // í‚¤ì›Œë“œë³„ ì•„ì´ì½˜ ë°˜í™˜
    function getKeywordIcon(keyword) {
      const icons = {
        'AI': 'ğŸ¤–', 'ì¸ê³µì§€ëŠ¥': 'ğŸ¤–', 'GPT': 'ğŸ¤–',
        'ë°˜ë„ì²´': 'ğŸ”§', 'ë©”ëª¨ë¦¬': 'ğŸ’¾', 'CPU': 'âš¡',
        'ë°”ì´ì˜¤': 'ğŸ§¬', 'ì˜ë£Œ': 'ğŸ¥', 'í—¬ìŠ¤ì¼€ì–´': 'ğŸ’Š',
        'ìë™ì°¨': 'ğŸš—', 'ì „ê¸°ì°¨': 'ğŸ”‹', 'ë°°í„°ë¦¬': 'ğŸ”‹',
        'ë¸”ë¡ì²´ì¸': 'â›“ï¸', 'ì•”í˜¸í™”í': 'ğŸ’°', 'ë¹„íŠ¸ì½”ì¸': 'â‚¿',
        'ê²Œì„': 'ğŸ®', 'ë©”íƒ€ë²„ìŠ¤': 'ğŸ¥½', 'VR': 'ğŸ¥½',
        'í´ë¼ìš°ë“œ': 'â˜ï¸', 'ì„œë²„': 'ğŸ–¥ï¸', 'ë°ì´í„°': 'ğŸ“Š'
      };

      for (const [key, icon] of Object.entries(icons)) {
        if (keyword.includes(key)) return icon;
      }

      return 'ğŸ“°';
    }

    // í‚¤ì›Œë“œ íƒœê·¸ ìƒì„±
    function generateKeywordTags() {
      const relatedKeywords = [
        currentKeyword,
        'ê¸°ìˆ íŠ¸ë Œë“œ',
        'í˜ì‹ ',
        'ë¯¸ë˜ê¸°ìˆ ',
        'ì‚°ì—…ë¶„ì„'
      ];

      const tagsHTML = relatedKeywords.map(tag =>
        `<div class="keyword-tag" onclick="searchKeyword('${tag}')">#${tag}</div>`
      ).join('');

      document.getElementById('keywordTags').innerHTML = tagsHTML;
    }

    // ë¹„ë””ì˜¤ ì¬ìƒ (ì‹¤ì œë¡œëŠ” analysis.htmlë¡œ ì´ë™)
    function playVideo() {
      window.location.href = `/analysis.html?keyword=${encodeURIComponent(currentKeyword)}`;
    }

    // ì¢‹ì•„ìš” í† ê¸€
    function toggleLike() {
      isLiked = !isLiked;
      const likeBtn = document.querySelector('.action-btn');
      const likeCount = document.getElementById('likeCount');

      if (isLiked) {
        likeBtn.classList.add('liked');
        likeCount.textContent = parseInt(likeCount.textContent) + 1;
      } else {
        likeBtn.classList.remove('liked');
        likeCount.textContent = parseInt(likeCount.textContent) - 1;
      }
    }

    // êµ¬ë… í† ê¸€
    function toggleSubscribe() {
      isSubscribed = !isSubscribed;
      const subscribeBtn = document.querySelector('.subscribe-channel-btn');

      if (isSubscribed) {
        subscribeBtn.textContent = 'êµ¬ë…ì¤‘';
        subscribeBtn.classList.add('subscribed');
      } else {
        subscribeBtn.textContent = 'êµ¬ë…';
        subscribeBtn.classList.remove('subscribed');
      }
    }

    // ì„¤ëª… í† ê¸€
    function toggleDescription() {
      isDescriptionExpanded = !isDescriptionExpanded;
      const showMoreBtn = document.querySelector('.show-more');

      if (isDescriptionExpanded) {
        showMoreBtn.textContent = 'ê°„ëµíˆ';
      } else {
        showMoreBtn.textContent = 'ë”ë³´ê¸°';
      }
    }

    // ë¹„ë””ì˜¤ ê³µìœ 
    function shareVideo() {
      if (navigator.share) {
        navigator.share({
          title: `${currentKeyword} ë¶„ì„ ë¦¬í¬íŠ¸`,
          text: `${currentKeyword} ê´€ë ¨ ë‰´ìŠ¤ íŠ¸ë Œë“œ ë¶„ì„`,
          url: window.location.href
        });
      } else {
        // í´ë¦½ë³´ë“œì— URL ë³µì‚¬
        navigator.clipboard.writeText(window.location.href);
        alert('ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
      }
    }

    // ë¹„ë””ì˜¤ ì €ì¥
    function saveVideo() {
      alert('ì €ì¥ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤!');
    }

    // ê´€ë ¨ ë‰´ìŠ¤ ì—´ê¸°
    function openRelatedNews(keyword) {
      window.location.href = `/news-detail.html?keyword=${encodeURIComponent(keyword)}`;
    }

    // í‚¤ì›Œë“œ ê²€ìƒ‰
    function searchKeyword(keyword) {
      window.location.href = `/analysis.html?keyword=${encodeURIComponent(keyword)}`;
    }

    // ë’¤ë¡œê°€ê¸°
    function goBack() {
      if (document.referrer) {
        window.history.back();
      } else {
        window.location.href = '/';
      }
    }
  </script>
</body>

</html>